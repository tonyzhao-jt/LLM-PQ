/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
device_names ['Tesla_T4', 'Tesla_V100-SXM2-32GB']
device_numbers [3, 1]
device_info Tesla_T4_3_Tesla_V100-SXM2-32GB_1
Est model:  Tesla_T4_2_9216_36864_3.pkl
prefill MSE: 2742.4023|decode MSE: 0.0825|
Est model:  Tesla_T4_2_9216_36864_4.pkl
prefill MSE: 3223.0469|decode MSE: 0.0454|
Est model:  Tesla_T4_2_9216_36864_16.pkl
prefill MSE: 68.0786|decode MSE: 0.3770|
Est model:  Tesla_T4_2_9216_36864_8:tc-li.pkl
prefill MSE: 4.0600|decode MSE: 0.0396|
Est model:  Tesla_T4_2_7168_28672_3.pkl
prefill MSE: 874.4513|decode MSE: 0.0887|
Est model:  Tesla_T4_2_7168_28672_4.pkl
prefill MSE: 1158.8437|decode MSE: 0.0562|
Est model:  Tesla_T4_2_7168_28672_16.pkl
prefill MSE: 14.8919|decode MSE: 0.1056|
Est model:  Tesla_T4_2_7168_28672_8:tc-li.pkl
prefill MSE: 5.4209|decode MSE: 0.0264|
Est model:  Tesla_T4_2_5120_20480_3.pkl
prefill MSE: 706.0849|decode MSE: 0.1336|
Est model:  Tesla_T4_2_5120_20480_4.pkl
prefill MSE: 718.1520|decode MSE: 0.0850|
Est model:  Tesla_T4_2_5120_20480_16.pkl
prefill MSE: 343.2962|decode MSE: 0.0162|
Est model:  Tesla_T4_2_5120_20480_8:tc-li.pkl
prefill MSE: 4.1662|decode MSE: 0.0341|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Loading model:  Tesla_T4_2_9216_36864_3.pkl
prefill MSE: 2742.4023|decode MSE: 0.0825|
Loading model:  Tesla_T4_2_9216_36864_4.pkl
prefill MSE: 3223.0469|decode MSE: 0.0454|
Loading model:  Tesla_T4_2_9216_36864_16.pkl
prefill MSE: 68.0786|decode MSE: 0.3770|
Loading model:  Tesla_T4_2_9216_36864_8:tc-li.pkl
prefill MSE: 4.0600|decode MSE: 0.0396|
Loading model:  Tesla_T4_2_7168_28672_3.pkl
prefill MSE: 874.4513|decode MSE: 0.0887|
Loading model:  Tesla_T4_2_7168_28672_4.pkl
prefill MSE: 1158.8437|decode MSE: 0.0562|
Loading model:  Tesla_T4_2_7168_28672_16.pkl
prefill MSE: 14.8919|decode MSE: 0.1056|
Loading model:  Tesla_T4_2_7168_28672_8:tc-li.pkl
prefill MSE: 5.4209|decode MSE: 0.0264|
Loading model:  Tesla_T4_2_5120_20480_3.pkl
prefill MSE: 706.0849|decode MSE: 0.1336|
Loading model:  Tesla_T4_2_5120_20480_4.pkl
prefill MSE: 718.1520|decode MSE: 0.0850|
Loading model:  Tesla_T4_2_5120_20480_16.pkl
prefill MSE: 343.2962|decode MSE: 0.0162|
Loading model:  Tesla_T4_2_5120_20480_8:tc-li.pkl
prefill MSE: 4.1662|decode MSE: 0.0341|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.65856008739
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 965996
Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 816 rows, 1152 columns and 4406 nonzeros
Model fingerprint: 0x6ed1f51f
Variable types: 0 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+03]
  Objective range  [2e-09, 8e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+04]
Presolve removed 445 rows and 272 columns
Presolve time: 0.02s
Presolved: 371 rows, 880 columns, 2860 nonzeros
Variable types: 0 continuous, 880 integer (880 binary)

Root relaxation: objective 6.042039e-03, 514 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00604    0  150          -    0.00604      -     -    0s
H    0     0                       3.2789179    0.00604   100%     -    0s
H    0     0                       0.4715908    0.00604  98.7%     -    0s
     0     0    0.00610    0  103    0.47159    0.00610  98.7%     -    0s
H    0     0                       0.3425968    0.00610  98.2%     -    0s
H    0     0                       0.0062407    0.00610  2.26%     -    0s
     0     0    0.00615    0  180    0.00624    0.00615  1.39%     -    0s
     0     0    0.00615    0  103    0.00624    0.00615  1.39%     -    0s
     0     0    0.00615    0   76    0.00624    0.00615  1.39%     -    0s
H    0     0                       0.0062321    0.00615  1.25%     -    0s
H    0     0                       0.0061943    0.00615  0.65%     -    0s
     0     0    0.00615    0  128    0.00619    0.00615  0.65%     -    0s
     0     0    0.00615    0   94    0.00619    0.00615  0.65%     -    0s
     0     0    0.00617    0   94    0.00619    0.00617  0.36%     -    0s
     0     0     cutoff    0         0.00619    0.00619  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Cover: 3
  MIR: 3
  StrongCG: 1
  GUB cover: 1

Explored 1 nodes (1312 simplex iterations) in 0.21 seconds (0.10 work units)
Thread count was 32 (of 80 available processors)

Solution count 6: 0.00619428 0.00623214 0.00624068 ... 3.27892

Optimal solution found (tolerance 1.00e-04)
Best objective 6.194280490060e-03, best bound 6.194280490060e-03, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
Adabits result found
mem_j = 9580.0
mem_j = 11828.0
mem_j = 11828.0
mem_j = 28360.0
Try (32, 2, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 840 rows, 1162 columns and 5974 nonzeros
Model fingerprint: 0x9d8f0a84
Variable types: 10 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 3e+03]
  Objective range  [9e-05, 4e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 457 rows and 321 columns
Presolve time: 0.02s
Presolved: 383 rows, 841 columns, 4128 nonzeros
Variable types: 6 continuous, 835 integer (835 binary)

Root relaxation: objective 1.083553e+05, 559 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 108355.264    0  214          - 108355.264      -     -    0s
H    0     0                    6952187.6419 112333.562  98.4%     -    0s
H    0     0                    470058.68993 122958.551  73.8%     -    0s
     0     0 122958.551    0  248 470058.690 122958.551  73.8%     -    0s
H    0     0                    151068.66961 122958.556  18.6%     -    0s
H    0     0                    123891.34033 122958.556  0.75%     -    0s
     0     0 123256.468    0  138 123891.340 123256.468  0.51%     -    0s
     0     0 123256.468    0  106 123891.340 123256.468  0.51%     -    0s
     0     0 123256.468    0   76 123891.340 123256.468  0.51%     -    0s
     0     0 123259.531    0   60 123891.340 123259.531  0.51%     -    0s
     0     0 123259.531    0   78 123891.340 123259.531  0.51%     -    0s
     0     0 123259.531    0   69 123891.340 123259.531  0.51%     -    0s
     0     0 123259.531    0   64 123891.340 123259.531  0.51%     -    0s
     0     0 123273.013    0   49 123891.340 123273.013  0.50%     -    0s
     0     0 123273.013    0   58 123891.340 123273.013  0.50%     -    0s
     0     0 123279.981    0   58 123891.340 123279.981  0.49%     -    0s
     0     0 123279.981    0   50 123891.340 123279.981  0.49%     -    0s
     0     0 123311.361    0   46 123891.340 123311.361  0.47%     -    0s
     0     0 123338.297    0   21 123891.340 123338.297  0.45%     -    0s
     0     0 123391.330    0   26 123891.340 123391.330  0.40%     -    0s
     0     0 123391.330    0   26 123891.340 123391.330  0.40%     -    0s
     0     0 123391.330    0   35 123891.340 123391.330  0.40%     -    0s
     0     0 123391.330    0   35 123891.340 123391.330  0.40%     -    0s
     0     0 123391.652    0    8 123891.340 123391.652  0.40%     -    0s
     0     0 123401.608    0   35 123891.340 123401.608  0.40%     -    0s
     0     0 123404.756    0   11 123891.340 123404.756  0.39%     -    0s
     0     0 123404.756    0   11 123891.340 123404.756  0.39%     -    0s
     0     0 123404.756    0   43 123891.340 123404.756  0.39%     -    0s
     0     0 123414.975    0   43 123891.340 123414.975  0.38%     -    0s
     0     0 123414.975    0   10 123891.340 123414.975  0.38%     -    0s
     0     0 123634.316    0   35 123891.340 123634.316  0.21%     -    0s
     0     0 123635.090    0   14 123891.340 123635.090  0.21%     -    0s
     0     0 123696.702    0    4 123891.340 123696.702  0.16%     -    0s
     0     0 123714.582    0   43 123891.340 123714.582  0.14%     -    0s
     0     0          -    0      123891.340 123890.927  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Cover: 2
  MIR: 6
  StrongCG: 3
  GUB cover: 1
  RLT: 1

Explored 1 nodes (2821 simplex iterations) in 0.58 seconds (0.27 work units)
Thread count was 32 (of 80 available processors)

Solution count 5: 123891 151069 203577 ... 6.95219e+06

Optimal solution found (tolerance 1.00e-04)
Best objective 1.238913403250e+05, best bound 1.238909267013e+05, gap 0.0003%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 104304.40107796367
Objective = 123891.34032504962
123891.34032504962 inf
Better Plan Generated
Try (32, 4, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 840 rows, 1162 columns and 5974 nonzeros
Model fingerprint: 0x29d86ca6
Variable types: 10 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+03]
  Objective range  [9e-05, 4e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 457 rows and 321 columns
Presolve time: 0.02s
Presolved: 383 rows, 841 columns, 4128 nonzeros
Variable types: 6 continuous, 835 integer (835 binary)

Root relaxation: objective 7.962535e+04, 398 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 79625.3453    0  146          - 79625.3453      -     -    0s
H    0     0                    6634571.5532 79625.9292  98.8%     -    0s
H    0     0                    304129.97994 88049.0058  71.0%     -    0s
H    0     0                    241437.64068 88049.0058  63.5%     -    0s
H    0     0                    154387.28470 88049.0058  43.0%     -    0s
H    0     0                    149621.14370 88049.0058  41.2%     -    0s
     0     0 88049.0058    0  195 149621.144 88049.0058  41.2%     -    0s
     0     0 88061.5413    0  184 149621.144 88061.5413  41.1%     -    0s
H    0     0                    147338.08124 88061.5413  40.2%     -    0s
H    0     0                    145294.08174 88061.5413  39.4%     -    0s
H    0     0                    95979.665804 88061.5413  8.25%     -    0s
H    0     0                    93137.870175 88061.5413  5.45%     -    0s
H    0     0                    93135.795240 88061.5413  5.45%     -    0s
H    0     0                    92877.975801 88061.5413  5.19%     -    0s
     0     0 91324.0504    0   88 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0   86 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0   56 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0    4 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0   10 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0   30 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0    6 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0   26 92877.9758 91324.0504  1.67%     -    0s
     0     0 91324.0504    0    8 92877.9758 91324.0504  1.67%     -    0s
     0     0 91332.7454    0    4 92877.9758 91332.7454  1.66%     -    0s
     0     0 92816.5158    0    4 92877.9758 92816.5158  0.07%     -    0s
     0     0 92816.5312    0    6 92877.9758 92816.5312  0.07%     -    0s
     0     0 92816.5312    0    8 92877.9758 92816.5312  0.07%     -    0s
     0     0 92816.5312    0    3 92877.9758 92816.5312  0.07%     -    0s

Cutting planes:
  Cover: 2
  MIR: 1
  RLT: 1

Explored 1 nodes (2003 simplex iterations) in 0.40 seconds (0.22 work units)
Thread count was 32 (of 80 available processors)

Solution count 10: 92878 93135.8 93137.9 ... 154387

Optimal solution found (tolerance 1.00e-04)
Best objective 9.287797580130e+04, best bound 9.287797580130e+04, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 83251.31997432253
Objective = 92877.97580130187
92877.97580130187 123891.34032504962
Better Plan Generated
Try (32, 8, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 840 rows, 1162 columns and 5974 nonzeros
Model fingerprint: 0x6e91d019
Variable types: 10 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+04]
  Objective range  [9e-05, 4e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 457 rows and 321 columns
Presolve time: 0.02s
Presolved: 383 rows, 841 columns, 4128 nonzeros
Variable types: 6 continuous, 835 integer (835 binary)

Root relaxation: objective 6.486747e+04, 462 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64867.4717    0  189          - 64867.4717      -     -    0s
H    0     0                    6870762.5886 64867.4717  99.1%     -    0s
H    0     0                    283250.79649 85355.3751  69.9%     -    0s
     0     0 85355.3751    0  241 283250.796 85355.3751  69.9%     -    0s
H    0     0                    274720.00418 85355.3751  68.9%     -    0s
H    0     0                    102300.63541 85355.3751  16.6%     -    0s
H    0     0                    102205.22783 85355.3751  16.5%     -    0s
H    0     0                    87636.043830 85355.3751  2.60%     -    0s
H    0     0                    86187.988425 85355.3751  0.97%     -    0s
H    0     0                    86181.259419 85355.3751  0.96%     -    0s
H    0     0                    86180.843912 85355.3751  0.96%     -    0s
     0     0 85907.1901    0   62 86180.8439 85907.1901  0.32%     -    0s
     0     0     cutoff    0      86180.8439 86180.8439  0.00%     -    0s

Explored 1 nodes (946 simplex iterations) in 0.21 seconds (0.13 work units)
Thread count was 32 (of 80 available processors)

Solution count 8: 86180.8 86181.3 86188 ... 6.87076e+06

Optimal solution found (tolerance 1.00e-04)
Best objective 8.618084391245e+04, best bound 8.618084391245e+04, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 85840.70677885374
Objective = 86180.8439124463
86180.8439124463 92877.97580130187
Better Plan Generated
Try (32, 2, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 840 rows, 1162 columns and 5974 nonzeros
Model fingerprint: 0xad99c674
Variable types: 10 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 3e+03]
  Objective range  [9e-05, 4e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 458 rows and 322 columns
Presolve time: 0.02s
Presolved: 382 rows, 840 columns, 4126 nonzeros
Variable types: 5 continuous, 835 integer (835 binary)

Root relaxation: objective 7.114144e+04, 452 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 71141.4381    0  176          - 71141.4381      -     -    0s
H    0     0                    843923.92565 71141.4381  91.6%     -    0s
H    0     0                    175716.62252 92436.9429  47.4%     -    0s
H    0     0                    154119.67450 92436.9429  40.0%     -    0s
H    0     0                    149539.03471 92436.9429  38.2%     -    0s
     0     0 92620.3052    0  240 149539.035 92620.3052  38.1%     -    0s
     0     0 92649.9131    0  228 149539.035 92649.9131  38.0%     -    0s
H    0     0                    149535.16440 92695.6310  38.0%     -    0s
     0     0 92695.6310    0  211 149535.164 92695.6310  38.0%     -    0s
H    0     0                    149532.73634 92695.6310  38.0%     -    0s
H    0     0                    132516.06887 94651.1464  28.6%     -    0s
     0     0 94819.0049    0   78 132516.069 94819.0049  28.4%     -    0s
     0     0 94819.0049    0  186 132516.069 94819.0049  28.4%     -    0s
     0     0 94819.0049    0  174 132516.069 94819.0049  28.4%     -    0s
H    0     0                    129735.67293 94819.0049  26.9%     -    0s
     0     0 94819.0049    0   84 129735.673 94819.0049  26.9%     -    0s
H    0     0                    99569.709430 94823.0937  4.77%     -    0s
     0     0 94849.1803    0  113 99569.7094 94849.1803  4.74%     -    0s
     0     0 94858.0466    0  109 99569.7094 94858.0466  4.73%     -    0s
     0     0 94858.5025    0  114 99569.7094 94858.5025  4.73%     -    0s
     0     0 96392.1148    0   53 99569.7094 96392.1148  3.19%     -    0s
     0     0 96392.1148    0   63 99569.7094 96392.1148  3.19%     -    0s
     0     0 96392.1148    0   59 99569.7094 96392.1148  3.19%     -    0s
     0     0 96392.1148    0   21 99569.7094 96392.1148  3.19%     -    0s
     0     0 96463.3175    0   21 99569.7094 96463.3175  3.12%     -    0s
     0     0 97320.2412    0   38 99569.7094 97320.2412  2.26%     -    0s
     0     0 97320.2831    0   24 99569.7094 97320.2831  2.26%     -    0s
     0     0 97321.1330    0   45 99569.7094 97321.1330  2.26%     -    0s
     0     0 97325.1536    0   45 99569.7094 97325.1536  2.25%     -    0s
     0     0 97325.7893    0   30 99569.7094 97325.7893  2.25%     -    0s
     0     0 97326.2095    0   31 99569.7094 97326.2095  2.25%     -    0s
     0     0 97326.2127    0   31 99569.7094 97326.2127  2.25%     -    0s
     0     0 97327.4337    0   26 99569.7094 97327.4337  2.25%     -    0s
     0     0 97380.9566    0   21 99569.7094 97380.9566  2.20%     -    0s
     0     0 97382.1808    0   20 99569.7094 97382.1808  2.20%     -    0s
     0     0 97382.4800    0   21 99569.7094 97382.4800  2.20%     -    0s
     0     0 97587.8077    0   15 99569.7094 97587.8077  1.99%     -    0s
     0     0 97612.3649    0    7 99569.7094 97612.3649  1.97%     -    0s
     0     0 97612.8805    0    7 99569.7094 97612.8805  1.97%     -    0s
     0     0 98087.8771    0    5 99569.7094 98087.8771  1.49%     -    0s
     0     0 99479.6549    0    5 99569.7094 99479.6549  0.09%     -    0s
     0     0 99481.1059    0    5 99569.7094 99481.1059  0.09%     -    0s
     0     0 99481.5112    0    8 99569.7094 99481.5112  0.09%     -    0s
     0     0 99482.4569    0   11 99569.7094 99482.4569  0.09%     -    0s

Cutting planes:
  Gomory: 2
  Cover: 6
  MIR: 5
  StrongCG: 3
  GUB cover: 1

Explored 1 nodes (2120 simplex iterations) in 0.47 seconds (0.21 work units)
Thread count was 32 (of 80 available processors)

Solution count 8: 99569.7 129736 149533 ... 843924

Optimal solution found (tolerance 1.00e-04)
Best objective 9.956970943034e+04, best bound 9.956970943034e+04, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 99175.83484692032
Objective = 99569.70943034039
99569.70943034039 86180.8439124463
Try (32, 4, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 840 rows, 1162 columns and 5974 nonzeros
Model fingerprint: 0x87f1ac5b
Variable types: 10 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 6e+03]
  Objective range  [9e-05, 4e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 458 rows and 322 columns
Presolve time: 0.02s
Presolved: 382 rows, 840 columns, 4126 nonzeros
Variable types: 5 continuous, 835 integer (835 binary)

Root relaxation: objective 5.552254e+04, 548 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 55522.5406    0  231          - 55522.5406      -     -    0s
H    0     0                    327512.72000 55522.5406  83.0%     -    0s
H    0     0                    183553.77816 55522.5406  69.8%     -    0s
H    0     0                    113284.05372 79160.1849  30.1%     -    0s
     0     0 79160.1849    0  152 113284.054 79160.1849  30.1%     -    0s
H    0     0                    81086.635181 79160.1849  2.38%     -    0s
     0     0 79162.9266    0    6 81086.6352 79162.9266  2.37%     -    0s
     0     0 79162.9266    0  104 81086.6352 79162.9266  2.37%     -    0s
     0     0 79162.9266    0  138 81086.6352 79162.9266  2.37%     -    0s
     0     0 79162.9266    0  114 81086.6352 79162.9266  2.37%     -    0s
     0     0 79611.1080    0    2 81086.6352 79611.1080  1.82%     -    0s
     0     0 79611.1080    0   78 81086.6352 79611.1080  1.82%     -    0s
     0     0 79611.1080    0   95 81086.6352 79611.1080  1.82%     -    0s
     0     0 79611.1080    0   81 81086.6352 79611.1080  1.82%     -    0s
     0     0 79611.1080    0    1 81086.6352 79611.1080  1.82%     -    0s
     0     0 79611.1080    0    2 81086.6352 79611.1080  1.82%     -    0s
     0     0 81086.6333    0   23 81086.6352 81086.6333  0.00%     -    0s

Cutting planes:
  Gomory: 10
  Cover: 3
  MIR: 9
  StrongCG: 3
  GUB cover: 5
  RLT: 1

Explored 1 nodes (1647 simplex iterations) in 0.32 seconds (0.16 work units)
Thread count was 32 (of 80 available processors)

Solution count 4: 81086.6 113284 183554 327513 

Optimal solution found (tolerance 1.00e-04)
Best objective 8.108663518086e+04, best bound 8.108663326258e+04, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 80692.76059743701
Objective = 81086.63518085709
81086.63518085709 86180.8439124463
Better Plan Generated
Try (32, 8, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 840 rows, 1162 columns and 5974 nonzeros
Model fingerprint: 0xf2baecb3
Variable types: 10 continuous, 1152 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+04]
  Objective range  [9e-05, 4e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 458 rows and 322 columns
Presolve time: 0.02s
Presolved: 382 rows, 840 columns, 4126 nonzeros
Variable types: 5 continuous, 835 integer (835 binary)

Root relaxation: objective 5.218239e+04, 447 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52182.3900    0  235          - 52182.3900      -     -    0s
H    0     0                    166542.31323 52208.2991  68.7%     -    0s
     0     0 74260.9816    0  170 166542.313 74260.9816  55.4%     -    0s
H    0     0                    157529.25820 74260.9983  52.9%     -    0s
H    0     0                    157437.04380 74260.9983  52.8%     -    0s
H    0     0                    138894.76964 74260.9983  46.5%     -    0s
H    0     0                    77046.835652 74260.9983  3.62%     -    0s
H    0     0                    76884.035096 74260.9983  3.41%     -    0s
H    0     0                    76882.820795 74260.9983  3.41%     -    0s
     0     0 74263.7767    0   79 76882.8208 74263.7767  3.41%     -    0s
     0     0 74263.7767    0   45 76882.8208 74263.7767  3.41%     -    0s
     0     0 74263.7767    0   28 76882.8208 74263.7767  3.41%     -    0s
     0     0 74335.1532    0   11 76882.8208 74335.1532  3.31%     -    0s
     0     0 74336.2037    0   23 76882.8208 74336.2037  3.31%     -    0s
     0     0 74372.5712    0   23 76882.8208 74372.5712  3.27%     -    0s

Cutting planes:
  Gomory: 3
  Cover: 2
  MIR: 3
  RLT: 2

Explored 1 nodes (735 simplex iterations) in 0.21 seconds (0.11 work units)
Thread count was 32 (of 80 available processors)

Solution count 7: 76882.8 76884 77046.8 ... 166542

Optimal solution found (tolerance 1.00e-04)
Best objective 7.688282079469e+04, best bound 7.688029031307e+04, gap 0.0033%
[34mINFO:llm_pq:Try uniform bit: 16[0m
[34mINFO:llm_pq:Try uniform bit: 8:tc-li[0m
[34mINFO:llm_pq:Try uniform bit: 4[0m
Gurobi status= 2
T_sum = 76481.22261391969
Objective = 76882.82079469191
76882.82079469191 81086.63518085709
Better Plan Generated
best plan:  {'prefill_bz': 8, 'bz_decode_max': 8, 'bz_decode_bss': [8, 8, 8, 8], 'device_names': ('Tesla_V100-SXM2-32GB', 'Tesla_T4'), 'device_numbers': (1, 3), 'plan': {'partition_result': {0: [0, 18], 1: [18, 28], 2: [28, 38], 3: [38, 48]}, 'bit_assignment': {0: 16, 1: 16, 2: '8:tc-li', 3: '8:tc-li', 4: 16, 5: 16, 6: 16, 7: 16, 8: '8:tc-li', 9: '8:tc-li', 10: '8:tc-li', 11: '8:tc-li', 12: '8:tc-li', 13: '8:tc-li', 14: '8:tc-li', 15: '8:tc-li', 16: '8:tc-li', 17: '8:tc-li', 18: 16, 19: 16, 20: '8:tc-li', 21: '8:tc-li', 22: 16, 23: 16, 24: '8:tc-li', 25: '8:tc-li', 26: 16, 27: 16, 28: 16, 29: 16, 30: 16, 31: 16, 32: 16, 33: 16, 34: 16, 35: 16, 36: '8:tc-li', 37: '8:tc-li', 38: '8:tc-li', 39: '8:tc-li', 40: '8:tc-li', 41: '8:tc-li', 42: '8:tc-li', 43: '8:tc-li', 44: '8:tc-li', 45: '8:tc-li', 46: '8:tc-li', 47: '8:tc-li', 48: '8:tc-li', 49: '8:tc-li', 50: '8:tc-li', 51: '8:tc-li', 52: '8:tc-li', 53: '8:tc-li', 54: '8:tc-li', 55: '8:tc-li', 56: '8:tc-li', 57: '8:tc-li', 58: '8:tc-li', 59: '8:tc-li', 60: '8:tc-li', 61: '8:tc-li', 62: '8:tc-li', 63: '8:tc-li', 64: '8:tc-li', 65: '8:tc-li', 66: '8:tc-li', 67: '8:tc-li', 68: '8:tc-li', 69: '8:tc-li', 70: '8:tc-li', 71: '8:tc-li', 72: '8:tc-li', 73: '8:tc-li', 74: '8:tc-li', 75: '8:tc-li', 76: '8:tc-li', 77: '8:tc-li', 78: '8:tc-li', 79: '8:tc-li', 80: '8:tc-li', 81: '8:tc-li', 82: '8:tc-li', 83: '8:tc-li', 84: '8:tc-li', 85: '8:tc-li', 86: '8:tc-li', 87: '8:tc-li', 88: '8:tc-li', 89: '8:tc-li', 90: '8:tc-li', 91: '8:tc-li', 92: '8:tc-li', 93: '8:tc-li', 94: '8:tc-li', 95: '8:tc-li'}}, 'obj': 76882.82079469191, 'D': {0: 'Tesla_V100-SXM2-32GB', 1: 'Tesla_T4', 2: 'Tesla_T4', 3: 'Tesla_T4'}, 'maps': {0: 3, 1: 0, 2: 1, 3: 2}, 'name': 'llm_pq'}
Loading model:  Tesla_T4_2_9216_36864_3.pkl
prefill MSE: 2742.4023|decode MSE: 0.0825|
Loading model:  Tesla_T4_2_9216_36864_4.pkl
prefill MSE: 3223.0469|decode MSE: 0.0454|
Loading model:  Tesla_T4_2_9216_36864_16.pkl
prefill MSE: 68.0786|decode MSE: 0.3770|
Loading model:  Tesla_T4_2_9216_36864_8:tc-li.pkl
prefill MSE: 4.0600|decode MSE: 0.0396|
Loading model:  Tesla_T4_2_7168_28672_3.pkl
prefill MSE: 874.4513|decode MSE: 0.0887|
Loading model:  Tesla_T4_2_7168_28672_4.pkl
prefill MSE: 1158.8437|decode MSE: 0.0562|
Loading model:  Tesla_T4_2_7168_28672_16.pkl
prefill MSE: 14.8919|decode MSE: 0.1056|
Loading model:  Tesla_T4_2_7168_28672_8:tc-li.pkl
prefill MSE: 5.4209|decode MSE: 0.0264|
Loading model:  Tesla_T4_2_5120_20480_3.pkl
prefill MSE: 706.0849|decode MSE: 0.1336|
Loading model:  Tesla_T4_2_5120_20480_4.pkl
prefill MSE: 718.1520|decode MSE: 0.0850|
Loading model:  Tesla_T4_2_5120_20480_16.pkl
prefill MSE: 343.2962|decode MSE: 0.0162|
Loading model:  Tesla_T4_2_5120_20480_8:tc-li.pkl
prefill MSE: 4.1662|decode MSE: 0.0341|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.65856008739
Total memory required: 80.22784423828125 GB available memory:  64.6799375 GB
The model is too large to fit in the device mesh
Total memory required: 80.22784423828125 GB available memory:  64.6799375 GB
The model is too large to fit in the device mesh
Total memory required: 80.22784423828125 GB available memory:  64.6799375 GB
The model is too large to fit in the device mesh
Loading model:  Tesla_T4_2_9216_36864_3.pkl
prefill MSE: 2742.4023|decode MSE: 0.0825|
Loading model:  Tesla_T4_2_9216_36864_4.pkl
prefill MSE: 3223.0469|decode MSE: 0.0454|
Loading model:  Tesla_T4_2_9216_36864_16.pkl
prefill MSE: 68.0786|decode MSE: 0.3770|
Loading model:  Tesla_T4_2_9216_36864_8:tc-li.pkl
prefill MSE: 4.0600|decode MSE: 0.0396|
Loading model:  Tesla_T4_2_7168_28672_3.pkl
prefill MSE: 874.4513|decode MSE: 0.0887|
Loading model:  Tesla_T4_2_7168_28672_4.pkl
prefill MSE: 1158.8437|decode MSE: 0.0562|
Loading model:  Tesla_T4_2_7168_28672_16.pkl
prefill MSE: 14.8919|decode MSE: 0.1056|
Loading model:  Tesla_T4_2_7168_28672_8:tc-li.pkl
prefill MSE: 5.4209|decode MSE: 0.0264|
Loading model:  Tesla_T4_2_5120_20480_3.pkl
prefill MSE: 706.0849|decode MSE: 0.1336|
Loading model:  Tesla_T4_2_5120_20480_4.pkl
prefill MSE: 718.1520|decode MSE: 0.0850|
Loading model:  Tesla_T4_2_5120_20480_16.pkl
prefill MSE: 343.2962|decode MSE: 0.0162|
Loading model:  Tesla_T4_2_5120_20480_8:tc-li.pkl
prefill MSE: 4.1662|decode MSE: 0.0341|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.65856008739
The model is too large to fit in the device mesh
min(each_device_mem_availability):  10483.263595703123 Uniform requries mem:  13482.0
The model is too large to fit in the device mesh
min(each_device_mem_availability):  10483.263595703123 Uniform requries mem:  13482.0
The model is too large to fit in the device mesh
min(each_device_mem_availability):  10013.875656249998 Uniform requries mem:  13482.0
Loading model:  Tesla_T4_2_9216_36864_3.pkl
prefill MSE: 2742.4023|decode MSE: 0.0825|
Loading model:  Tesla_T4_2_9216_36864_4.pkl
prefill MSE: 3223.0469|decode MSE: 0.0454|
[34mINFO:llm_pq:Uniform solution found, use bit: 4[0m
[34mINFO:llm_pq:Try pipeedge bit: 16[0m
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Loading model:  Tesla_T4_2_9216_36864_16.pkl
prefill MSE: 68.0786|decode MSE: 0.3770|
Loading model:  Tesla_T4_2_9216_36864_8:tc-li.pkl
prefill MSE: 4.0600|decode MSE: 0.0396|
Loading model:  Tesla_T4_2_7168_28672_3.pkl
prefill MSE: 874.4513|decode MSE: 0.0887|
Loading model:  Tesla_T4_2_7168_28672_4.pkl
prefill MSE: 1158.8437|decode MSE: 0.0562|
Loading model:  Tesla_T4_2_7168_28672_16.pkl
prefill MSE: 14.8919|decode MSE: 0.1056|
Loading model:  Tesla_T4_2_7168_28672_8:tc-li.pkl
prefill MSE: 5.4209|decode MSE: 0.0264|
Loading model:  Tesla_T4_2_5120_20480_3.pkl
prefill MSE: 706.0849|decode MSE: 0.1336|
Loading model:  Tesla_T4_2_5120_20480_4.pkl
prefill MSE: 718.1520|decode MSE: 0.0850|
Loading model:  Tesla_T4_2_5120_20480_16.pkl
prefill MSE: 343.2962|decode MSE: 0.0162|
Loading model:  Tesla_T4_2_5120_20480_8:tc-li.pkl
prefill MSE: 4.1662|decode MSE: 0.0341|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.65856008739
Prefill cost stage [34111.67948952584, 34111.67948952584, 34111.67948952584, 6752.124581103224]
Decode cost stage [291.8848046800521, 291.8848046800521, 291.8848046800521, 72.730924623155]
Prefill Time 620762.36ms, Decode Time 87638.17ms, E2E Latency 708400.53ms
Prefill cost stage [67409.89240878141, 67409.89240878141, 67409.89240878141, 13619.106674296074]
Decode cost stage [291.8848046800521, 291.8848046800521, 291.8848046800521, 72.730924623155]
Prefill Time 687718.03ms, Decode Time 87638.17ms, E2E Latency 775356.20ms
Prefill cost stage [134006.3182472925, 134006.3182472925, 134006.3182472925, 27353.070860681764]
Decode cost stage [291.8848046800521, 291.8848046800521, 291.8848046800521, 72.730924623155]
Prefill Time 831390.98ms, Decode Time 87638.17ms, E2E Latency 919029.15ms
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 64 rows, 197 columns and 592 nonzeros
Model fingerprint: 0xa2841ed7
Variable types: 5 continuous, 192 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 8 rows and 4 columns
Presolve time: 0.00s
Presolved: 56 rows, 193 columns, 580 nonzeros
Variable types: 1 continuous, 192 integer (192 binary)

Root relaxation: infeasible, 56 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 infeasible    0               - infeasible      -     -    0s

Explored 1 nodes (56 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 32 (of 80 available processors)

Solution count 0

Model is infeasible
Best objective -, best bound -, gap -
[34mINFO:llm_pq:Try pipeedge bit: 8:tc-li[0m
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1316: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 3
Pipedge Result not feasible
Set parameter TimeLimit to value 60
Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 40 physical cores, 80 logical processors, using up to 32 threads

Academic license 965996 - for non-commercial use only - registered to ju___@connect.hku.hk
Optimize a model with 64 rows, 197 columns and 592 nonzeros
Model fingerprint: 0x493c567f
Variable types: 5 continuous, 192 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-01, 3e+04]
Presolve removed 8 rows and 4 columns
Presolve time: 0.00s
Presolved: 56 rows, 193 columns, 580 nonzeros
Variable types: 1 continuous, 192 integer (192 binary)
Found heuristic solution: objective 386.5919877
Found heuristic solution: objective 309.2735901

Root relaxation: cutoff, 73 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0     cutoff    0       309.27359  309.27359  0.00%     -    0s

Explored 1 nodes (73 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 32 (of 80 available processors)

Solution count 2: 309.274 386.592 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.092735901324e+02, best bound 3.092735901324e+02, gap 0.0000%
[34mINFO:llm_pq:PipeEdge solution found, use bit: 8:tc-li[0m
[34mINFO:llm_pq:start to run adabits[0m
[34mINFO:llm_pq:adabits result: Minimax Lat 68363.74002766138[0m
[34mINFO:llm_pq:start to run llm_pq[0m
[34mINFO:llm_pq:llm_pq result: Minimax Lat 58771.247350518475[0m
[34mINFO:llm_pq:start to run pipeedge[0m
[34mINFO:llm_pq:pipeedge result: Minimax Lat 104603.9132251165[0m
[34mINFO:llm_pq:start to run uniform[0m
[34mINFO:llm_pq:uniform result: Minimax Lat 919029.1526730757[0m
[34mINFO:llm_pq:Minimum bit of adabits[0m
[34mINFO:llm_pq:minimum_bit: 8[0m
[34mINFO:llm_pq:Minimum bit of llm_pq[0m
[34mINFO:llm_pq:minimum_bit: 8[0m
[34mINFO:llm_pq:Minimum bit of pipeedge[0m
[34mINFO:llm_pq:minimum_bit: 8[0m
[34mINFO:llm_pq:Minimum bit of uniform[0m
[34mINFO:llm_pq:minimum_bit: 4[0m
[34mINFO:llm_pq:llm_pq D not same[0m
[34mINFO:llm_pq:{0: 'Tesla_V100-SXM2-32GB', 1: 'Tesla_T4', 2: 'Tesla_T4', 3: 'Tesla_T4'}[0m
[34mINFO:llm_pq:llm_pq: 2.94954514503479[0m
[34mINFO:llm_pq:All plans saved to sols_opt_30b_Tesla_T4_3_Tesla_V100-SXM2-32GB_1group1.pkl in /workspace/llm_pq/scripts/part_strategy[0m
Gurobi status= 2
Pipedge Result found
Prefill cost stage [1476.9780956469135, 1823.1488439439258, 1823.1488439439258, 1795.0268997283374]
Decode cost stage [66.67953918141022, 83.25995978378565, 83.25995978378565, 187.05634682489097]
Prefill Time 12387.75ms, Decode Time 55975.99ms, E2E Latency 68363.74ms
Prefill cost stage [1610.980224701955, 1730.8537414850618, 1730.8537414850618, 1730.8537414850618]
Decode cost stage [156.12898781164606, 82.90210301187714, 82.90210301187714, 82.90210301187714]
Prefill Time 11996.10ms, Decode Time 46775.14ms, E2E Latency 58771.25ms
Prefill cost stage [1384.6829931880495, 1730.8537414850618, 1730.8537414850618, 1840.4667502638233]
Decode cost stage [66.32168240950172, 82.90210301187714, 82.90210301187714, 309.27359013244893]
Prefill Time 12208.26ms, Decode Time 92395.66ms, E2E Latency 104603.91ms
Prefill cost stage [134006.3182472925, 134006.3182472925, 134006.3182472925, 27353.070860681764]
Decode cost stage [291.8848046800521, 291.8848046800521, 291.8848046800521, 72.730924623155]
Prefill Time 831390.98ms, Decode Time 87638.17ms, E2E Latency 919029.15ms
Result saved to /workspace/llm_pq/scripts/part_strategy/sols_opt_30b_Tesla_T4_3_Tesla_V100-SXM2-32GB_1group1.pkl
