/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1352: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
device_names ['Tesla_V100-SXM2-32GB']
device_numbers [4]
device_info Tesla_V100-SXM2-32GB_4
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Est model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Est model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Est model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Est model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.658560087384
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 965996
Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Set parameter TimeLimit to value 60
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (linux64)

CPU model: AMD EPYC 7H12 64-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 128 physical cores, 256 logical processors, using up to 32 threads

Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Optimize a model with 1088 rows, 1536 columns and 5878 nonzeros
Model fingerprint: 0xed1494d5
Variable types: 0 continuous, 1536 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 3e+03]
  Objective range  [1e-09, 8e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+04]
Presolve removed 589 rows and 350 columns
Presolve time: 0.03s
Presolved: 499 rows, 1186 columns, 3856 nonzeros
Variable types: 0 continuous, 1186 integer (1186 binary)
Found heuristic solution: objective 13.8942929

Root relaxation: objective 1.012732e-02, 653 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.01013    0  172   13.89429    0.01013   100%     -    0s
H    0     0                       1.3799912    0.01013  99.3%     -    0s
H    0     0                       0.3472106    0.01013  97.1%     -    0s
H    0     0                       0.3471289    0.01013  97.1%     -    0s
H    0     0                       0.2057236    0.01013  95.1%     -    0s
     0     0    0.01039    0  254    0.20572    0.01039  95.0%     -    0s
     0     0    0.01039    0  233    0.20572    0.01039  95.0%     -    0s
H    0     0                       0.1936058    0.01039  94.6%     -    0s
H    0     0                       0.1842310    0.01039  94.4%     -    0s
     0     0    0.01039    0  227    0.18423    0.01039  94.4%     -    0s
     0     0    0.01039    0  200    0.18423    0.01039  94.4%     -    0s
H    0     0                       0.0107251    0.01039  3.16%     -    0s
H    0     0                       0.0104996    0.01039  1.08%     -    0s
     0     0    0.01040    0  123    0.01050    0.01040  0.94%     -    0s
     0     0    0.01040    0   26    0.01050    0.01040  0.94%     -    0s
     0     0    0.01040    0   76    0.01050    0.01040  0.94%     -    0s
     0     0    0.01040    0   17    0.01050    0.01040  0.93%     -    0s
     0     0    0.01041    0   21    0.01050    0.01041  0.81%     -    0s
     0     0     cutoff    0         0.01050    0.01050  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Cover: 2
  MIR: 4
  StrongCG: 2
  GUB cover: 2
  RLT: 1

Explored 1 nodes (2369 simplex iterations) in 0.32 seconds (0.16 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: 0.0104996 0.0107251 0.184231 ... 13.8943

Optimal solution found (tolerance 1.00e-04)
Best objective 1.049957862365e-02, best bound 1.049957862365e-02, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1352: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
Adabits result found
mem_j = 24915.0
mem_j = 28237.0
mem_j = 28237.0
mem_j = 27831.0
Try (32, 2, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (linux64)

CPU model: AMD EPYC 7H12 64-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 128 physical cores, 256 logical processors, using up to 32 threads

Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Optimize a model with 568 rows, 778 columns and 3990 nonzeros
Model fingerprint: 0xec2f95d4
Variable types: 10 continuous, 768 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+03]
  Objective range  [2e-09, 3e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 3e+04]
Presolve removed 317 rows and 320 columns
Presolve time: 0.02s
Presolved: 251 rows, 458 columns, 2248 nonzeros
Variable types: 4 continuous, 454 integer (454 binary)

Root relaxation: objective 1.324007e+05, 470 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 132400.725    0  115          - 132400.725      -     -    0s
H    0     0                    169877.50640 135588.713  20.2%     -    0s
     0     0 135588.713    0  132 169877.506 135588.713  20.2%     -    0s
     0     0 135588.713    0  134 169877.506 135588.713  20.2%     -    0s
H    0     0                    169237.21440 135588.713  19.9%     -    0s
H    0     0                    168355.63786 135588.713  19.5%     -    0s
H    0     0                    168292.15449 135588.713  19.4%     -    0s
     0     0 141315.733    0  160 168292.154 141315.733  16.0%     -    0s
     0     0 141315.733    0  146 168292.154 141315.733  16.0%     -    0s
H    0     0                    168292.15443 141315.733  16.0%     -    0s
     0     0 141434.908    0  145 168292.154 141434.908  16.0%     -    0s
     0     0 141434.914    0  169 168292.154 141434.914  16.0%     -    0s
     0     0 141434.914    0  169 168292.154 141434.914  16.0%     -    0s
     0     0 141434.914    0   85 168292.154 141434.914  16.0%     -    0s
     0     0 141434.914    0  176 168292.154 141434.914  16.0%     -    0s
     0     0 141434.914    0  164 168292.154 141434.914  16.0%     -    0s
     0     0 143573.744    0  150 168292.154 143573.744  14.7%     -    0s
     0     0 143573.745    0  145 168292.154 143573.745  14.7%     -    0s
     0     0 143573.745    0  145 168292.154 143573.745  14.7%     -    0s
     0     2 143573.745    0  145 168292.154 143573.745  14.7%     -    0s
H  138    66                    168292.11777 143573.798  14.7%  24.9    0s
H86677 29663                    168292.11613 167348.656  0.56%   2.0    2s
H95862 32111                    168292.11492 167348.667  0.56%   2.0    2s
H95948 30552                    168292.11477 167348.667  0.56%   2.0    2s
H116861 32180                    168292.11453 167348.667  0.56%   2.0    3s
 229136 43012 167348.669  100    4 168292.115 167348.669  0.56%   1.9    5s
H561076 54164                    168292.10858 167348.738  0.56%   1.9    9s
H561108 51392                    168292.10695 167348.738  0.56%   1.9    9s
H561110 48756                    168292.10599 167348.738  0.56%   1.9    9s
H561117 46250                    168292.10508 167348.738  0.56%   1.9    9s
 567178 52645 168189.447  140    8 168292.105 167348.741  0.56%   1.9   10s
 1034340 118267 167738.937  138   10 168292.105 167738.909  0.33%   1.7   15s
 1335527 126612 168189.423  137   12 168292.105 168189.422  0.06%   1.8   20s
 1596938 120468 168189.500  144    8 168292.105 168189.496  0.06%   1.7   25s
 1829472 102419 168189.670  141   13 168292.105 168189.593  0.06%   1.7   30s
 2075427 94480 168189.713  151    8 168292.105 168189.703  0.06%   1.7   35s
 2323135 87381     cutoff  149      168292.105 168189.749  0.06%   1.7   40s
 2577830 73799     cutoff  140      168292.105 168189.845  0.06%   1.7   45s
H2729437 70792                    168292.10500 168189.917  0.06%   1.7   48s
 2813188 65585 168189.970  153    7 168292.105 168189.964  0.06%   1.7   50s
 3042951 47248 168214.167  147    8 168292.105 168214.163  0.05%   1.7   55s

Cutting planes:
  Gomory: 7
  Cover: 72
  MIR: 104
  StrongCG: 5
  Flow cover: 278
  Inf proof: 1
  Zero half: 2

Explored 3176101 nodes (5329369 simplex iterations) in 57.61 seconds (32.83 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: 168292 168292 168292 ... 169878

Optimal solution found (tolerance 1.00e-04)
Best objective 1.682921177881e+05, best bound 1.682906088982e+05, gap 0.0009%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1352: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 168291.14758910093
Objective = 168292.11778811124
168292.11778811124 inf
Better Plan Generated
Try (32, 4, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (linux64)

CPU model: AMD EPYC 7H12 64-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 128 physical cores, 256 logical processors, using up to 32 threads

Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Optimize a model with 568 rows, 778 columns and 3990 nonzeros
Model fingerprint: 0x088f0790
Variable types: 10 continuous, 768 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 5e+03]
  Objective range  [2e-09, 3e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 3e+04]
Presolve removed 317 rows and 320 columns
Presolve time: 0.02s
Presolved: 251 rows, 458 columns, 2248 nonzeros
Variable types: 4 continuous, 454 integer (454 binary)

Root relaxation: objective 1.292285e+05, 428 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 129228.529    0  140          - 129228.529      -     -    0s
     0     0 142431.954    0  177          - 142431.954      -     -    0s
H    0     0                    176009.61988 144528.447  17.9%     -    0s
H    0     0                    173367.11175 144528.447  16.6%     -    0s
     0     0 144806.697    0  148 173367.112 144806.697  16.5%     -    0s
H    0     0                    173366.69824 144806.697  16.5%     -    0s
H    0     0                    167022.91262 144806.697  13.3%     -    0s
H    0     0                    167017.88916 144806.697  13.3%     -    0s
H    0     0                    167017.88915 144806.697  13.3%     -    0s
H    0     0                    162034.93179 144806.697  10.6%     -    0s
H    0     0                    162034.84905 144806.697  10.6%     -    0s
H    0     0                    160020.68548 144806.697  9.51%     -    0s
     0     0 144806.701    0  148 160020.685 144806.701  9.51%     -    0s
     0     0 144806.701    0  142 160020.685 144806.701  9.51%     -    0s
     0     0 144806.701    0  138 160020.685 144806.701  9.51%     -    0s
     0     0 144806.701    0  138 160020.685 144806.701  9.51%     -    0s
     0     2 144806.701    0  138 160020.685 144806.701  9.51%     -    0s

Cutting planes:
  Gomory: 6
  Cover: 51
  Implied bound: 2
  MIR: 3
  StrongCG: 3
  GUB cover: 1

Explored 3914 nodes (48555 simplex iterations) in 0.75 seconds (0.53 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: 160021 162035 162035 ... 176010

Optimal solution found (tolerance 1.00e-04)
Best objective 1.600206854841e+05, best bound 1.600206854841e+05, gap 0.0000%
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1352: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 2
T_sum = 160020.4346875293
Objective = 160020.68548406946
160020.68548406946 168292.11778811124
Better Plan Generated
Try (32, 8, 8)
Set parameter TimeLimit to value 60
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (linux64)

CPU model: AMD EPYC 7H12 64-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 128 physical cores, 256 logical processors, using up to 32 threads

Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Optimize a model with 568 rows, 778 columns and 3990 nonzeros
Model fingerprint: 0xb4c10f97
Variable types: 10 continuous, 768 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 8e+03]
  Objective range  [2e-09, 3e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 3e+04]
Presolve removed 317 rows and 320 columns
Presolve time: 0.02s
Presolved: 251 rows, 458 columns, 2248 nonzeros
Variable types: 4 continuous, 454 integer (454 binary)

Root relaxation: objective 1.297239e+05, 364 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 129723.944    0  164          - 129723.944      -     -    0s
H    0     0                    285264.95898 129723.944  54.5%     -    0s
H    0     0                    263691.61386 129723.944  50.8%     -    0s
     0     0 143016.828    0   92 263691.614 143016.828  45.8%     -    0s
H    0     0                    242244.96260 143016.828  41.0%     -    0s
H    0     0                    161592.48897 143016.833  11.5%     -    0s
H    0     0                    156382.21871 143016.833  8.55%     -    0s
     0     0 143016.833    0  117 156382.219 143016.833  8.55%     -    0s
     0     0 147453.967    0  136 156382.219 147453.967  5.71%     -    0s
     0     0 147453.967    0  133 156382.219 147453.967  5.71%     -    0s
     0     0 147455.697    0  136 156382.219 147455.697  5.71%     -    0s
     0     0 147455.697    0  136 156382.219 147455.697  5.71%     -    0s
     0     0 147455.697    0  104 156382.219 147455.697  5.71%     -    0s
     0     0 147455.697    0   92 156382.219 147455.697  5.71%     -    0s
     0     0 147455.697    0  108 156382.219 147455.697  5.71%     -    0s
     0     0 147455.697    0   87 156382.219 147455.697  5.71%     -    0s
     0     0 148138.767    0  100 156382.219 148138.767  5.27%     -    0s
     0     0 148372.778    0  101 156382.219 148372.778  5.12%     -    0s
     0     0 148379.802    0   99 156382.219 148379.802  5.12%     -    0s
     0     0 148379.802    0  100 156382.219 148379.802  5.12%     -    0s
     0     0 148862.231    0  105 156382.219 148862.231  4.81%     -    0s
     0     0 148863.463    0  105 156382.219 148863.463  4.81%     -    0s
     0     0 148863.463    0   67 156382.219 148863.463  4.81%     -    0s
     0     0 148863.463    0   80 156382.219 148863.463  4.81%     -    0s
     0     0 148863.463    0   72 156382.219 148863.463  4.81%     -    0s
     0     0 148863.463    0   90 156382.219 148863.463  4.81%     -    0s
     0     0 148898.486    0   83 156382.219 148898.486  4.79%     -    0s
     0     0 149192.192    0   88 156382.219 149192.192  4.60%     -    0s
     0     0 149192.192    0   88 156382.219 149192.192  4.60%     -    0s
     0     0 149791.124    0  104 156382.219 149791.124  4.21%     -    0s
     0     0 149791.124    0   84 156382.219 149791.124  4.21%     -    0s
     0     0 149791.124    0   71 156382.219 149791.124  4.21%     -    0s
     0     0 149791.125    0   78 156382.219 149791.125  4.21%     -    0s
     0     0 149791.125    0   73 156382.219 149791.125  4.21%     -    0s
     0     0 149791.129    0   52 156382.219 149791.129  4.21%     -    0s
     0     0 149791.129    0   77 156382.219 149791.129  4.21%     -    0s
     0     0 149791.129    0   69 156382.219 149791.129  4.21%     -    0s
     0     0 149791.129    0   49 156382.219 149791.129  4.21%     -    0s
     0     0 149791.129    0   47 156382.219 149791.129  4.21%     -    0s
     0     0 149791.129    0   59 156382.219 149791.129  4.21%     -    0s
     0     0 149895.967    0   89 156382.219 149895.967  4.15%     -    0s
     0     0 149895.970    0   81 156382.219 149895.970  4.15%     -    0s
     0     0 149895.975    0   68 156382.219 149895.975  4.15%     -    0s
     0     0 149895.976    0   81 156382.219 149895.976  4.15%     -    0s
     0     0 149895.977    0   69 156382.219 149895.977  4.15%     -    0s
     0     0 149896.064    0   69 156382.219 149896.064  4.15%     -    0s
     0     0 149896.064    0   50 156382.219 149896.064  4.15%     -    0s
     0     2 149896.064    0   47 156382.219 149896.064  4.15%     -    0s

Cutting planes:
  Gomory: 11
  Cover: 3
  MIR: 4
  StrongCG: 3
  GUB cover: 1
  RLT: 1

Explored 56 nodes (3017 simplex iterations) in 0.56 seconds (0.31 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: 156382 161592 242245 ... 285265

Optimal solution found (tolerance 1.00e-04)
Best objective 1.563822187124e+05, best bound 1.563822187124e+05, gap 0.0000%
Gurobi status= 2
T_sum = 156381.96791587846
Objective = 156382.21871241863
156382.21871241863 160020.68548406946
Better Plan Generated
best plan:  {'prefill_bz': 8, 'bz_decode_max': 8, 'bz_decode_bss': [8, 8, 8, 8], 'device_names': ('Tesla_V100-SXM2-32GB',), 'device_numbers': (4,), 'plan': {'partition_result': {0: [0, 16], 1: [16, 32], 2: [32, 48], 3: [48, 64]}, 'bit_assignment': {0: 3, 1: 3, 2: 3, 3: 3, 4: '8:tc-li', 5: '8:tc-li', 6: '8:tc-li', 7: '8:tc-li', 8: '8:tc-li', 9: '8:tc-li', 10: '8:tc-li', 11: '8:tc-li', 12: '8:tc-li', 13: '8:tc-li', 14: '8:tc-li', 15: '8:tc-li', 16: '8:tc-li', 17: '8:tc-li', 18: '8:tc-li', 19: '8:tc-li', 20: '8:tc-li', 21: '8:tc-li', 22: '8:tc-li', 23: '8:tc-li', 24: '8:tc-li', 25: '8:tc-li', 26: '8:tc-li', 27: '8:tc-li', 28: '8:tc-li', 29: '8:tc-li', 30: '8:tc-li', 31: '8:tc-li', 32: '8:tc-li', 33: '8:tc-li', 34: '8:tc-li', 35: '8:tc-li', 36: '8:tc-li', 37: '8:tc-li', 38: '8:tc-li', 39: '8:tc-li', 40: '8:tc-li', 41: '8:tc-li', 42: '8:tc-li', 43: '8:tc-li', 44: '8:tc-li', 45: '8:tc-li', 46: '8:tc-li', 47: '8:tc-li', 48: '8:tc-li', 49: '8:tc-li', 50: '8:tc-li', 51: '8:tc-li', 52: '8:tc-li', 53: '8:tc-li', 54: '8:tc-li', 55: '8:tc-li', 56: '8:tc-li', 57: '8:tc-li', 58: '8:tc-li', 59: '8:tc-li', 60: '8:tc-li', 61: '8:tc-li', 62: '8:tc-li', 63: '8:tc-li', 64: '8:tc-li', 65: '8:tc-li', 66: '8:tc-li', 67: '8:tc-li', 68: '8:tc-li', 69: '8:tc-li', 70: '8:tc-li', 71: '8:tc-li', 72: '8:tc-li', 73: '8:tc-li', 74: '8:tc-li', 75: '8:tc-li', 76: '8:tc-li', 77: '8:tc-li', 78: '8:tc-li', 79: '8:tc-li', 80: '8:tc-li', 81: '8:tc-li', 82: '8:tc-li', 83: '8:tc-li', 84: '8:tc-li', 85: '8:tc-li', 86: '8:tc-li', 87: '8:tc-li', 88: '8:tc-li', 89: '8:tc-li', 90: '8:tc-li', 91: '8:tc-li', 92: '8:tc-li', 93: '8:tc-li', 94: '8:tc-li', 95: '8:tc-li', 96: '8:tc-li', 97: '8:tc-li', 98: '8:tc-li', 99: '8:tc-li', 100: '8:tc-li', 101: '8:tc-li', 102: '8:tc-li', 103: '8:tc-li', 104: '8:tc-li', 105: '8:tc-li', 106: '8:tc-li', 107: '8:tc-li', 108: '8:tc-li', 109: '8:tc-li', 110: '8:tc-li', 111: '8:tc-li', 112: '8:tc-li', 113: '8:tc-li', 114: '8:tc-li', 115: '8:tc-li', 116: '8:tc-li', 117: '8:tc-li', 118: '8:tc-li', 119: '8:tc-li', 120: '8:tc-li', 121: '8:tc-li', 122: '8:tc-li', 123: '8:tc-li', 124: '8:tc-li', 125: '8:tc-li', 126: '8:tc-li', 127: '8:tc-li'}}, 'obj': 156382.21871241863, 'D': {0: 'Tesla_V100-SXM2-32GB', 1: 'Tesla_V100-SXM2-32GB', 2: 'Tesla_V100-SXM2-32GB', 3: 'Tesla_V100-SXM2-32GB'}, 'maps': {0: 0, 1: 1, 2: 2, 3: 3}, 'name': 'shaq'}
Try uniform bit:  16
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.658560087384
Total memory required: 164.533447265625 GB available memory:  113.0729375 GB
The model is too large to fit in the device mesh
Total memory required: 164.533447265625 GB available memory:  113.0729375 GB
The model is too large to fit in the device mesh
Total memory required: 164.533447265625 GB available memory:  113.0729375 GB
The model is too large to fit in the device mesh
Try uniform bit:  8:tc-li
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.658560087384
The model is too large to fit in the device mesh
min(each_device_mem_availability):  26445.649783203124 Uniform requries mem:  26568.0
The model is too large to fit in the device mesh
min(each_device_mem_availability):  26445.649783203124 Uniform requries mem:  26568.0
The model is too large to fit in the device mesh
min(each_device_mem_availability):  25843.26184375 Uniform requries mem:  26568.0
Try uniform bit:  4
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_8:tc-li.pkl
prefill MSE: 1.3490|decode MSE: 0.0324|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_3.pkl
prefill MSE: 31.7105|decode MSE: 0.0137|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_4.pkl
prefill MSE: 18.0841|decode MSE: 0.0076|
Loading model:  Tesla_V100-SXM2-32GB_2_9216_36864_16.pkl
prefill MSE: 263.9227|decode MSE: 0.0031|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_8:tc-li.pkl
prefill MSE: 0.9312|decode MSE: 0.0290|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_3.pkl
prefill MSE: 4.1599|decode MSE: 0.0243|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_4.pkl
prefill MSE: 4.4266|decode MSE: 0.0209|
Loading model:  Tesla_V100-SXM2-32GB_2_5120_20480_16.pkl
prefill MSE: 7.1557|decode MSE: 0.0012|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_8:tc-li.pkl
prefill MSE: 7.2594|decode MSE: 0.0224|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_3.pkl
prefill MSE: 15.5508|decode MSE: 0.0215|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_4.pkl
prefill MSE: 15.3923|decode MSE: 0.0153|
Loading model:  Tesla_V100-SXM2-32GB_2_7168_28672_16.pkl
prefill MSE: 23.7516|decode MSE: 0.0008|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_8:tc-li.pkl
prefill MSE: 23.7406|decode MSE: 0.1040|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_3.pkl
prefill MSE: 15221.3525|decode MSE: 0.0318|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_4.pkl
prefill MSE: 32033.6586|decode MSE: 0.0298|
Loading model:  Tesla_V100-SXM2-32GB_2_14336_57344_16.pkl
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1352: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
prefill MSE: 1071.9871|decode MSE: 0.0346|
Verified all regress models, maximum mse:  32033.658560087384
Prefill cost stage [14818.671168616835, 14818.671168616835, 14818.671168616835, 14818.671168616835]
Decode cost stage [147.80696156133624, 147.80696156133624, 147.80696156133624, 147.80696156133624]
Prefill Time 281554.75ms, Decode Time 44489.90ms, E2E Latency 326044.65ms
Prefill cost stage [29878.39880986004, 29878.39880986004, 29878.39880986004, 29878.39880986004]
Decode cost stage [147.80696156133624, 147.80696156133624, 147.80696156133624, 147.80696156133624]
Prefill Time 328662.39ms, Decode Time 44489.90ms, E2E Latency 373152.28ms
Prefill cost stage [59997.854092346395, 59997.854092346395, 59997.854092346395, 59997.854092346395]
Decode cost stage [147.80696156133624, 147.80696156133624, 147.80696156133624, 147.80696156133624]
Prefill Time 419984.98ms, Decode Time 44489.90ms, E2E Latency 464474.87ms
Uniform solution found, use bit:  4
Try pipeedge bit:  16
Set parameter TimeLimit to value 60
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (linux64)

CPU model: AMD EPYC 7H12 64-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 128 physical cores, 256 logical processors, using up to 32 threads

Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Optimize a model with 80 rows, 261 columns and 784 nonzeros
Model fingerprint: 0x92816ada
Variable types: 5 continuous, 256 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 3e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 3e+04]
Presolve removed 8 rows and 0 columns
Presolve time: 0.00s
Presolved: 72 rows, 261 columns, 524 nonzeros
Variable types: 1 continuous, 260 integer (256 binary)

Root relaxation: infeasible, 68 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 infeasible    0               - infeasible      -     -    0s

Explored 1 nodes (68 simplex iterations) in 0.02 seconds (0.00 work units)
Thread count was 32 (of 256 available processors)

Solution count 0

Model is infeasible
Best objective -, best bound -, gap -
/opt/conda/lib/python3.10/site-packages/pulp/pulp.py:1352: UserWarning: Spaces are not permitted in the name. Converted to '_'
  warnings.warn("Spaces are not permitted in the name. Converted to '_'")
Gurobi status= 3
Pipedge Result not feasible
Try pipeedge bit:  8:tc-li
Set parameter TimeLimit to value 60
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (linux64)

CPU model: AMD EPYC 7H12 64-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 128 physical cores, 256 logical processors, using up to 32 threads

Academic license - for non-commercial use only - registered to juntaozh@connect.hku.hk
Optimize a model with 80 rows, 261 columns and 784 nonzeros
Model fingerprint: 0x89ff0fdf
Variable types: 5 continuous, 256 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-02, 3e+04]
Presolve removed 8 rows and 0 columns
Presolve time: 0.00s
Presolved: 72 rows, 261 columns, 524 nonzeros
Variable types: 1 continuous, 260 integer (256 binary)
Found heuristic solution: objective 400.0577621

Root relaxation: objective 3.843692e+02, 87 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  384.36922    0    9  400.05776  384.36922  3.92%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 1
  RLT: 3

Explored 1 nodes (87 simplex iterations) in 0.02 seconds (0.00 work units)
Thread count was 32 (of 256 available processors)

Solution count 1: 400.058 

Optimal solution found (tolerance 1.00e-04)
Best objective 4.000577621348e+02, best bound 4.000577621348e+02, gap 0.0000%
Gurobi status= 2
Pipedge Result found
PipeEdge solution found, use bit:  8:tc-li
start to run adabits
Prefill cost stage [2152.6804290351306, 2439.7044862398147, 2439.7044862398147, 2228.043408236632]
Decode cost stage [352.9921430601357, 400.0577621348204, 400.0577621348204, 296.31587353975357]
Prefill Time 16579.25ms, Decode Time 120266.58ms, E2E Latency 136845.83ms
adabits result: Minimax Lat 136845.82516338202
start to run shaq
Prefill cost stage [7526.2291824999975, 2296.1924576374727, 2296.1924576374727, 2296.1924576374727]
Decode cost stage [344.03982968475157, 376.52495259747803, 376.52495259747803, 376.52495259747803]
Prefill Time 36993.49ms, Decode Time 113301.53ms, E2E Latency 150295.02ms
shaq result: Minimax Lat 150295.01971184058
start to run pipeedge
Prefill cost stage [1865.6563718304467, 2439.7044862398147, 2439.7044862398147, 2439.7044862398147]
Decode cost stage [305.92652398545096, 400.0577621348204, 400.0577621348204, 400.0577621348204]
Prefill Time 16503.88ms, Decode Time 120323.26ms, E2E Latency 136827.14ms
pipeedge result: Minimax Lat 136827.1384537009
start to run uniform
Prefill cost stage [59997.854092346395, 59997.854092346395, 59997.854092346395, 59997.854092346395]
Decode cost stage [147.80696156133624, 147.80696156133624, 147.80696156133624, 147.80696156133624]
Prefill Time 419984.98ms, Decode Time 44489.90ms, E2E Latency 464474.87ms
uniform result: Minimax Lat 464474.874076387
Minimum bit of  adabits
minimum_bit:  8
Minimum bit of  shaq
minimum_bit:  3
Minimum bit of  pipeedge
minimum_bit:  8
Minimum bit of  uniform
minimum_bit:  4
Shaq time:  59.27311301231384
Result saved to /workspace/shaq/scripts/part_strategy/sols_opt_66b_Tesla_V100-SXM2-32GB_4group_2.pkl
