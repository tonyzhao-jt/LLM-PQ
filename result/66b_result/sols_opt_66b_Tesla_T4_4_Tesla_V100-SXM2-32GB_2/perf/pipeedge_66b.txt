
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 7.5
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 7.5
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 7.5
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 7.5
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
rank 3 is in stage 3
rank 1 is in stage 1
rank 2 is in stage 2
Pipeline Data Loaded, with prefill cnts:  6
rank 0 is in stage 0
create layer: 15|create layer: 5|create layer: 10|create layer: 0|create layer: 16|create layer: 11|create layer: 6|create layer: 1|create layer: 17|create layer: 12|create layer: 7|create layer: 2|create layer: 13|create layer: 18|create layer: 8|create layer: 3|create layer: 14|create layer: 19|create layer: 9|create layer: 4|Stage 0 module sharded
Stage 0 kv initialized
Stage 2 module sharded
Stage 2 kv initialized
Stage 3 module sharded
Stage 3 kv initialized
Stage 1 module sharded
Stage 1 kv initialized
rank_src: 5, rank_dst: 1, rank: 0, results_cb: <function handle_results at 0x7f3cccad5af0>rank_src: 0, rank_dst: 2, rank: 1, results_cb: None

rank_src: 2, rank_dst: 4, rank: 3, results_cb: None
rank_src: 1, rank_dst: 3, rank: 2, results_cb: None
2023-05-27 12:31:20,322 - INFO - start pipe data
2023-05-27 12:37:33,598 - INFO - Request id 0 done for token 1
2023-05-27 12:38:39,753 - INFO - Request id 1 done for token 1
2023-05-27 12:39:31,731 - INFO - Request id 2 done for token 1
2023-05-27 12:40:23,730 - INFO - Request id 3 done for token 1
2023-05-27 12:41:15,752 - INFO - Request id 4 done for token 1
2023-05-27 12:42:07,781 - INFO - Request id 5 done for token 1
2023-05-27 12:42:08,587 - INFO - Latency is 648.264399, throughput is 0.049363
2023-05-27 12:42:08,587 - INFO - Token throughput is 0.098725
2023-05-27 12:42:18,599 - INFO - start pipe data
2023-05-27 12:48:24,364 - INFO - Request id 0 done for token 1
2023-05-27 12:49:35,778 - INFO - Request id 1 done for token 1
2023-05-27 12:50:27,766 - INFO - Request id 2 done for token 1
2023-05-27 12:51:19,780 - INFO - Request id 3 done for token 1
2023-05-27 12:52:11,789 - INFO - Request id 4 done for token 1
2023-05-27 12:53:03,820 - INFO - Request id 5 done for token 1
2023-05-27 12:53:03,937 - INFO - Request id 0 done for token 2
2023-05-27 12:53:04,099 - INFO - Request id 1 done for token 2
2023-05-27 12:53:04,229 - INFO - Request id 2 done for token 2
2023-05-27 12:53:04,354 - INFO - Request id 3 done for token 2
2023-05-27 12:53:04,492 - INFO - Request id 4 done for token 2
2023-05-27 12:53:04,628 - INFO - Request id 5 done for token 2
2023-05-27 12:53:04,787 - INFO - Request id 0 done for token 3
2023-05-27 12:53:04,947 - INFO - Request id 1 done for token 3
2023-05-27 12:53:05,086 - INFO - Request id 2 done for token 3
2023-05-27 12:53:05,222 - INFO - Request id 3 done for token 3
2023-05-27 12:53:05,359 - INFO - Request id 4 done for token 3
2023-05-27 12:53:05,494 - INFO - Request id 5 done for token 3
2023-05-27 12:53:05,653 - INFO - Request id 0 done for token 4
2023-05-27 12:53:05,811 - INFO - Request id 1 done for token 4
2023-05-27 12:53:05,948 - INFO - Request id 2 done for token 4
2023-05-27 12:53:06,086 - INFO - Request id 3 done for token 4
2023-05-27 12:53:06,222 - INFO - Request id 4 done for token 4
2023-05-27 12:53:06,358 - INFO - Request id 5 done for token 4
2023-05-27 12:53:06,517 - INFO - Request id 0 done for token 5
2023-05-27 12:53:06,676 - INFO - Request id 1 done for token 5
2023-05-27 12:53:06,813 - INFO - Request id 2 done for token 5
2023-05-27 12:53:06,953 - INFO - Request id 3 done for token 5
2023-05-27 12:53:07,086 - INFO - Request id 4 done for token 5
2023-05-27 12:53:07,222 - INFO - Request id 5 done for token 5
2023-05-27 12:53:07,381 - INFO - Request id 0 done for token 6
2023-05-27 12:53:07,541 - INFO - Request id 1 done for token 6
2023-05-27 12:53:07,677 - INFO - Request id 2 done for token 6
2023-05-27 12:53:07,813 - INFO - Request id 3 done for token 6
2023-05-27 12:53:07,948 - INFO - Request id 4 done for token 6
2023-05-27 12:53:08,088 - INFO - Request id 5 done for token 6
2023-05-27 12:53:08,248 - INFO - Request id 0 done for token 7
2023-05-27 12:53:08,409 - INFO - Request id 1 done for token 7
2023-05-27 12:53:08,547 - INFO - Request id 2 done for token 7
2023-05-27 12:53:08,684 - INFO - Request id 3 done for token 7
2023-05-27 12:53:08,817 - INFO - Request id 4 done for token 7
2023-05-27 12:53:08,952 - INFO - Request id 5 done for token 7
2023-05-27 12:53:09,109 - INFO - Request id 0 done for token 8
2023-05-27 12:53:09,266 - INFO - Request id 1 done for token 8
2023-05-27 12:53:09,403 - INFO - Request id 2 done for token 8
2023-05-27 12:53:09,538 - INFO - Request id 3 done for token 8
2023-05-27 12:53:09,673 - INFO - Request id 4 done for token 8
2023-05-27 12:53:09,808 - INFO - Request id 5 done for token 8
2023-05-27 12:53:09,966 - INFO - Request id 0 done for token 9
2023-05-27 12:53:10,128 - INFO - Request id 1 done for token 9
2023-05-27 12:53:10,266 - INFO - Request id 2 done for token 9
2023-05-27 12:53:10,402 - INFO - Request id 3 done for token 9
2023-05-27 12:53:10,539 - INFO - Request id 4 done for token 9
2023-05-27 12:53:10,676 - INFO - Request id 5 done for token 9
2023-05-27 12:53:10,833 - INFO - Request id 0 done for token 10
2023-05-27 12:53:10,992 - INFO - Request id 1 done for token 10
2023-05-27 12:53:11,125 - INFO - Request id 2 done for token 10
2023-05-27 12:53:11,261 - INFO - Request id 3 done for token 10
2023-05-27 12:53:11,398 - INFO - Request id 4 done for token 10
2023-05-27 12:53:11,534 - INFO - Request id 5 done for token 10
2023-05-27 12:53:11,692 - INFO - Request id 0 done for token 11
2023-05-27 12:53:11,852 - INFO - Request id 1 done for token 11
2023-05-27 12:53:11,987 - INFO - Request id 2 done for token 11
2023-05-27 12:53:12,122 - INFO - Request id 3 done for token 11
2023-05-27 12:53:12,258 - INFO - Request id 4 done for token 11
2023-05-27 12:53:12,393 - INFO - Request id 5 done for token 11
2023-05-27 12:53:12,558 - INFO - Request id 0 done for token 12
2023-05-27 12:53:12,713 - INFO - Request id 1 done for token 12
2023-05-27 12:53:12,847 - INFO - Request id 2 done for token 12
2023-05-27 12:53:12,983 - INFO - Request id 3 done for token 12
2023-05-27 12:53:13,119 - INFO - Request id 4 done for token 12
2023-05-27 12:53:13,255 - INFO - Request id 5 done for token 12
2023-05-27 12:53:13,413 - INFO - Request id 0 done for token 13
2023-05-27 12:53:13,572 - INFO - Request id 1 done for token 13
2023-05-27 12:53:13,708 - INFO - Request id 2 done for token 13
2023-05-27 12:53:13,845 - INFO - Request id 3 done for token 13
2023-05-27 12:53:13,984 - INFO - Request id 4 done for token 13
2023-05-27 12:53:14,121 - INFO - Request id 5 done for token 13
2023-05-27 12:53:14,281 - INFO - Request id 0 done for token 14
2023-05-27 12:53:14,441 - INFO - Request id 1 done for token 14
2023-05-27 12:53:14,579 - INFO - Request id 2 done for token 14
2023-05-27 12:53:14,714 - INFO - Request id 3 done for token 14
2023-05-27 12:53:14,851 - INFO - Request id 4 done for token 14
2023-05-27 12:53:14,988 - INFO - Request id 5 done for token 14
2023-05-27 12:53:15,146 - INFO - Request id 0 done for token 15
2023-05-27 12:53:15,306 - INFO - Request id 1 done for token 15
2023-05-27 12:53:15,443 - INFO - Request id 2 done for token 15
2023-05-27 12:53:15,580 - INFO - Request id 3 done for token 15
2023-05-27 12:53:15,719 - INFO - Request id 4 done for token 15
2023-05-27 12:53:15,854 - INFO - Request id 5 done for token 15
2023-05-27 12:53:16,012 - INFO - Request id 0 done for token 16
2023-05-27 12:53:16,172 - INFO - Request id 1 done for token 16
2023-05-27 12:53:16,310 - INFO - Request id 2 done for token 16
2023-05-27 12:53:16,447 - INFO - Request id 3 done for token 16
2023-05-27 12:53:16,583 - INFO - Request id 4 done for token 16
2023-05-27 12:53:16,721 - INFO - Request id 5 done for token 16
2023-05-27 12:53:16,879 - INFO - Request id 0 done for token 17
2023-05-27 12:53:17,037 - INFO - Request id 1 done for token 17
2023-05-27 12:53:17,174 - INFO - Request id 2 done for token 17
2023-05-27 12:53:17,311 - INFO - Request id 3 done for token 17
2023-05-27 12:53:17,447 - INFO - Request id 4 done for token 17
2023-05-27 12:53:17,582 - INFO - Request id 5 done for token 17
2023-05-27 12:53:17,741 - INFO - Request id 0 done for token 18
2023-05-27 12:53:17,900 - INFO - Request id 1 done for token 18
2023-05-27 12:53:18,036 - INFO - Request id 2 done for token 18
2023-05-27 12:53:18,172 - INFO - Request id 3 done for token 18
2023-05-27 12:53:18,309 - INFO - Request id 4 done for token 18
2023-05-27 12:53:18,447 - INFO - Request id 5 done for token 18
2023-05-27 12:53:18,607 - INFO - Request id 0 done for token 19
2023-05-27 12:53:18,768 - INFO - Request id 1 done for token 19
2023-05-27 12:53:18,906 - INFO - Request id 2 done for token 19
2023-05-27 12:53:19,046 - INFO - Request id 3 done for token 19
2023-05-27 12:53:19,184 - INFO - Request id 4 done for token 19
2023-05-27 12:53:19,321 - INFO - Request id 5 done for token 19
2023-05-27 12:53:19,484 - INFO - Request id 0 done for token 20
2023-05-27 12:53:19,646 - INFO - Request id 1 done for token 20
2023-05-27 12:53:19,783 - INFO - Request id 2 done for token 20
2023-05-27 12:53:19,923 - INFO - Request id 3 done for token 20
2023-05-27 12:53:20,057 - INFO - Request id 4 done for token 20
2023-05-27 12:53:20,195 - INFO - Request id 5 done for token 20
2023-05-27 12:53:20,357 - INFO - Request id 0 done for token 21
2023-05-27 12:53:20,518 - INFO - Request id 1 done for token 21
2023-05-27 12:53:20,656 - INFO - Request id 2 done for token 21
2023-05-27 12:53:20,792 - INFO - Request id 3 done for token 21
2023-05-27 12:53:20,929 - INFO - Request id 4 done for token 21
2023-05-27 12:53:21,070 - INFO - Request id 5 done for token 21
2023-05-27 12:53:21,225 - INFO - Request id 0 done for token 22
2023-05-27 12:53:21,386 - INFO - Request id 1 done for token 22
2023-05-27 12:53:21,523 - INFO - Request id 2 done for token 22
2023-05-27 12:53:21,660 - INFO - Request id 3 done for token 22
2023-05-27 12:53:21,796 - INFO - Request id 4 done for token 22
2023-05-27 12:53:21,935 - INFO - Request id 5 done for token 22
2023-05-27 12:53:22,096 - INFO - Request id 0 done for token 23
2023-05-27 12:53:22,258 - INFO - Request id 1 done for token 23
2023-05-27 12:53:22,395 - INFO - Request id 2 done for token 23
2023-05-27 12:53:22,534 - INFO - Request id 3 done for token 23
2023-05-27 12:53:22,672 - INFO - Request id 4 done for token 23
2023-05-27 12:53:22,813 - INFO - Request id 5 done for token 23
2023-05-27 12:53:22,974 - INFO - Request id 0 done for token 24
2023-05-27 12:53:23,134 - INFO - Request id 1 done for token 24
2023-05-27 12:53:23,271 - INFO - Request id 2 done for token 24
2023-05-27 12:53:23,408 - INFO - Request id 3 done for token 24
2023-05-27 12:53:23,545 - INFO - Request id 4 done for token 24
2023-05-27 12:53:23,683 - INFO - Request id 5 done for token 24
2023-05-27 12:53:23,842 - INFO - Request id 0 done for token 25
2023-05-27 12:53:24,001 - INFO - Request id 1 done for token 25
2023-05-27 12:53:24,138 - INFO - Request id 2 done for token 25
2023-05-27 12:53:24,274 - INFO - Request id 3 done for token 25
2023-05-27 12:53:24,410 - INFO - Request id 4 done for token 25
2023-05-27 12:53:24,547 - INFO - Request id 5 done for token 25
2023-05-27 12:53:24,707 - INFO - Request id 0 done for token 26
2023-05-27 12:53:24,867 - INFO - Request id 1 done for token 26
2023-05-27 12:53:25,005 - INFO - Request id 2 done for token 26
2023-05-27 12:53:25,143 - INFO - Request id 3 done for token 26
2023-05-27 12:53:25,276 - INFO - Request id 4 done for token 26
2023-05-27 12:53:25,414 - INFO - Request id 5 done for token 26
2023-05-27 12:53:25,574 - INFO - Request id 0 done for token 27
2023-05-27 12:53:25,735 - INFO - Request id 1 done for token 27
2023-05-27 12:53:25,872 - INFO - Request id 2 done for token 27
2023-05-27 12:53:26,008 - INFO - Request id 3 done for token 27
2023-05-27 12:53:26,144 - INFO - Request id 4 done for token 27
2023-05-27 12:53:26,282 - INFO - Request id 5 done for token 27
2023-05-27 12:53:26,440 - INFO - Request id 0 done for token 28
2023-05-27 12:53:26,601 - INFO - Request id 1 done for token 28
2023-05-27 12:53:26,737 - INFO - Request id 2 done for token 28
2023-05-27 12:53:26,873 - INFO - Request id 3 done for token 28
2023-05-27 12:53:27,009 - INFO - Request id 4 done for token 28
2023-05-27 12:53:27,147 - INFO - Request id 5 done for token 28
2023-05-27 12:53:27,306 - INFO - Request id 0 done for token 29
2023-05-27 12:53:27,467 - INFO - Request id 1 done for token 29
2023-05-27 12:53:27,603 - INFO - Request id 2 done for token 29
2023-05-27 12:53:27,740 - INFO - Request id 3 done for token 29
2023-05-27 12:53:27,877 - INFO - Request id 4 done for token 29
2023-05-27 12:53:28,014 - INFO - Request id 5 done for token 29
2023-05-27 12:53:28,174 - INFO - Request id 0 done for token 30
2023-05-27 12:53:28,333 - INFO - Request id 1 done for token 30
2023-05-27 12:53:28,471 - INFO - Request id 2 done for token 30
2023-05-27 12:53:28,608 - INFO - Request id 3 done for token 30
2023-05-27 12:53:28,754 - INFO - Request id 4 done for token 30
2023-05-27 12:53:28,883 - INFO - Request id 5 done for token 30
2023-05-27 12:53:29,042 - INFO - Request id 0 done for token 31
2023-05-27 12:53:29,201 - INFO - Request id 1 done for token 31
2023-05-27 12:53:29,338 - INFO - Request id 2 done for token 31
2023-05-27 12:53:29,474 - INFO - Request id 3 done for token 31
2023-05-27 12:53:29,610 - INFO - Request id 4 done for token 31
2023-05-27 12:53:29,747 - INFO - Request id 5 done for token 31
2023-05-27 12:53:29,907 - INFO - Request id 0 done for token 32
2023-05-27 12:53:30,067 - INFO - Request id 1 done for token 32
2023-05-27 12:53:30,203 - INFO - Request id 2 done for token 32
2023-05-27 12:53:30,340 - INFO - Request id 3 done for token 32
2023-05-27 12:53:30,477 - INFO - Request id 4 done for token 32
2023-05-27 12:53:30,614 - INFO - Request id 5 done for token 32
2023-05-27 12:53:30,774 - INFO - Request id 0 done for token 33
2023-05-27 12:53:30,933 - INFO - Request id 1 done for token 33
2023-05-27 12:53:31,068 - INFO - Request id 2 done for token 33
2023-05-27 12:53:31,206 - INFO - Request id 3 done for token 33
2023-05-27 12:53:31,343 - INFO - Request id 4 done for token 33
2023-05-27 12:53:31,482 - INFO - Request id 5 done for token 33
2023-05-27 12:53:31,642 - INFO - Request id 0 done for token 34
2023-05-27 12:53:31,803 - INFO - Request id 1 done for token 34
2023-05-27 12:53:31,940 - INFO - Request id 2 done for token 34
2023-05-27 12:53:32,077 - INFO - Request id 3 done for token 34
2023-05-27 12:53:32,214 - INFO - Request id 4 done for token 34
2023-05-27 12:53:32,351 - INFO - Request id 5 done for token 34
2023-05-27 12:53:32,512 - INFO - Request id 0 done for token 35
2023-05-27 12:53:32,673 - INFO - Request id 1 done for token 35
2023-05-27 12:53:32,811 - INFO - Request id 2 done for token 35
2023-05-27 12:53:32,948 - INFO - Request id 3 done for token 35
2023-05-27 12:53:33,085 - INFO - Request id 4 done for token 35
2023-05-27 12:53:33,222 - INFO - Request id 5 done for token 35
2023-05-27 12:53:33,382 - INFO - Request id 0 done for token 36
2023-05-27 12:53:33,543 - INFO - Request id 1 done for token 36
2023-05-27 12:53:33,680 - INFO - Request id 2 done for token 36
2023-05-27 12:53:33,818 - INFO - Request id 3 done for token 36
2023-05-27 12:53:33,955 - INFO - Request id 4 done for token 36
2023-05-27 12:53:34,092 - INFO - Request id 5 done for token 36
2023-05-27 12:53:34,252 - INFO - Request id 0 done for token 37
2023-05-27 12:53:34,413 - INFO - Request id 1 done for token 37
2023-05-27 12:53:34,550 - INFO - Request id 2 done for token 37
2023-05-27 12:53:34,687 - INFO - Request id 3 done for token 37
2023-05-27 12:53:34,825 - INFO - Request id 4 done for token 37
2023-05-27 12:53:34,968 - INFO - Request id 5 done for token 37
2023-05-27 12:53:35,129 - INFO - Request id 0 done for token 38
2023-05-27 12:53:35,292 - INFO - Request id 1 done for token 38
2023-05-27 12:53:35,516 - INFO - Request id 2 done for token 38
2023-05-27 12:53:35,585 - INFO - Request id 3 done for token 38
2023-05-27 12:53:35,712 - INFO - Request id 4 done for token 38
2023-05-27 12:53:35,841 - INFO - Request id 5 done for token 38
2023-05-27 12:53:36,001 - INFO - Request id 0 done for token 39
2023-05-27 12:53:36,163 - INFO - Request id 1 done for token 39
2023-05-27 12:53:36,301 - INFO - Request id 2 done for token 39
2023-05-27 12:53:36,438 - INFO - Request id 3 done for token 39
2023-05-27 12:53:36,577 - INFO - Request id 4 done for token 39
2023-05-27 12:53:36,712 - INFO - Request id 5 done for token 39
2023-05-27 12:53:36,873 - INFO - Request id 0 done for token 40
2023-05-27 12:53:37,032 - INFO - Request id 1 done for token 40
2023-05-27 12:53:37,169 - INFO - Request id 2 done for token 40
2023-05-27 12:53:37,307 - INFO - Request id 3 done for token 40
2023-05-27 12:53:37,443 - INFO - Request id 4 done for token 40
2023-05-27 12:53:37,581 - INFO - Request id 5 done for token 40
2023-05-27 12:53:37,740 - INFO - Request id 0 done for token 41
2023-05-27 12:53:37,900 - INFO - Request id 1 done for token 41
2023-05-27 12:53:38,036 - INFO - Request id 2 done for token 41
2023-05-27 12:53:38,178 - INFO - Request id 3 done for token 41
2023-05-27 12:53:38,311 - INFO - Request id 4 done for token 41
2023-05-27 12:53:38,449 - INFO - Request id 5 done for token 41
2023-05-27 12:53:38,610 - INFO - Request id 0 done for token 42
2023-05-27 12:53:38,769 - INFO - Request id 1 done for token 42
2023-05-27 12:53:38,906 - INFO - Request id 2 done for token 42
2023-05-27 12:53:39,043 - INFO - Request id 3 done for token 42
2023-05-27 12:53:39,179 - INFO - Request id 4 done for token 42
2023-05-27 12:53:39,315 - INFO - Request id 5 done for token 42
2023-05-27 12:53:39,474 - INFO - Request id 0 done for token 43
2023-05-27 12:53:39,634 - INFO - Request id 1 done for token 43
2023-05-27 12:53:39,770 - INFO - Request id 2 done for token 43
2023-05-27 12:53:39,907 - INFO - Request id 3 done for token 43
2023-05-27 12:53:40,045 - INFO - Request id 4 done for token 43
2023-05-27 12:53:40,182 - INFO - Request id 5 done for token 43
2023-05-27 12:53:40,341 - INFO - Request id 0 done for token 44
2023-05-27 12:53:40,502 - INFO - Request id 1 done for token 44
2023-05-27 12:53:40,638 - INFO - Request id 2 done for token 44
2023-05-27 12:53:40,777 - INFO - Request id 3 done for token 44
2023-05-27 12:53:40,915 - INFO - Request id 4 done for token 44
2023-05-27 12:53:41,056 - INFO - Request id 5 done for token 44
2023-05-27 12:53:41,216 - INFO - Request id 0 done for token 45
2023-05-27 12:53:41,380 - INFO - Request id 1 done for token 45
2023-05-27 12:53:41,513 - INFO - Request id 2 done for token 45
2023-05-27 12:53:41,650 - INFO - Request id 3 done for token 45
2023-05-27 12:53:41,786 - INFO - Request id 4 done for token 45
2023-05-27 12:53:41,923 - INFO - Request id 5 done for token 45
2023-05-27 12:53:42,083 - INFO - Request id 0 done for token 46
2023-05-27 12:53:42,243 - INFO - Request id 1 done for token 46
2023-05-27 12:53:42,381 - INFO - Request id 2 done for token 46
2023-05-27 12:53:42,518 - INFO - Request id 3 done for token 46
2023-05-27 12:53:42,655 - INFO - Request id 4 done for token 46
2023-05-27 12:53:42,792 - INFO - Request id 5 done for token 46
2023-05-27 12:53:42,952 - INFO - Request id 0 done for token 47
2023-05-27 12:53:43,112 - INFO - Request id 1 done for token 47
2023-05-27 12:53:43,250 - INFO - Request id 2 done for token 47
2023-05-27 12:53:43,388 - INFO - Request id 3 done for token 47
2023-05-27 12:53:43,524 - INFO - Request id 4 done for token 47
2023-05-27 12:53:43,662 - INFO - Request id 5 done for token 47
2023-05-27 12:53:43,821 - INFO - Request id 0 done for token 48
2023-05-27 12:53:43,982 - INFO - Request id 1 done for token 48
2023-05-27 12:53:44,119 - INFO - Request id 2 done for token 48
2023-05-27 12:53:44,255 - INFO - Request id 3 done for token 48
2023-05-27 12:53:44,392 - INFO - Request id 4 done for token 48
2023-05-27 12:53:44,530 - INFO - Request id 5 done for token 48
2023-05-27 12:53:44,689 - INFO - Request id 0 done for token 49
2023-05-27 12:53:44,851 - INFO - Request id 1 done for token 49
2023-05-27 12:53:44,987 - INFO - Request id 2 done for token 49
2023-05-27 12:53:45,125 - INFO - Request id 3 done for token 49
2023-05-27 12:53:45,266 - INFO - Request id 4 done for token 49
2023-05-27 12:53:45,405 - INFO - Request id 5 done for token 49
2023-05-27 12:53:45,566 - INFO - Request id 0 done for token 50
2023-05-27 12:53:45,726 - INFO - Request id 1 done for token 50
2023-05-27 12:53:45,863 - INFO - Request id 2 done for token 50
2023-05-27 12:53:46,001 - INFO - Request id 3 done for token 50
2023-05-27 12:53:46,139 - INFO - Request id 4 done for token 50
2023-05-27 12:53:46,276 - INFO - Request id 5 done for token 50
2023-05-27 12:53:46,438 - INFO - Request id 0 done for token 51
2023-05-27 12:53:46,598 - INFO - Request id 1 done for token 51
2023-05-27 12:53:46,741 - INFO - Request id 2 done for token 51
2023-05-27 12:53:46,874 - INFO - Request id 3 done for token 51
2023-05-27 12:53:47,012 - INFO - Request id 4 done for token 51
2023-05-27 12:53:47,148 - INFO - Request id 5 done for token 51
2023-05-27 12:53:47,309 - INFO - Request id 0 done for token 52
2023-05-27 12:53:47,469 - INFO - Request id 1 done for token 52
2023-05-27 12:53:47,607 - INFO - Request id 2 done for token 52
2023-05-27 12:53:47,744 - INFO - Request id 3 done for token 52
2023-05-27 12:53:47,880 - INFO - Request id 4 done for token 52
2023-05-27 12:53:48,017 - INFO - Request id 5 done for token 52
2023-05-27 12:53:48,179 - INFO - Request id 0 done for token 53
2023-05-27 12:53:48,340 - INFO - Request id 1 done for token 53
2023-05-27 12:53:48,477 - INFO - Request id 2 done for token 53
2023-05-27 12:53:48,618 - INFO - Request id 3 done for token 53
2023-05-27 12:53:48,752 - INFO - Request id 4 done for token 53
2023-05-27 12:53:48,889 - INFO - Request id 5 done for token 53
2023-05-27 12:53:49,049 - INFO - Request id 0 done for token 54
2023-05-27 12:53:49,209 - INFO - Request id 1 done for token 54
2023-05-27 12:53:49,346 - INFO - Request id 2 done for token 54
2023-05-27 12:53:49,483 - INFO - Request id 3 done for token 54
2023-05-27 12:53:49,621 - INFO - Request id 4 done for token 54
2023-05-27 12:53:49,757 - INFO - Request id 5 done for token 54
2023-05-27 12:53:49,917 - INFO - Request id 0 done for token 55
2023-05-27 12:53:50,078 - INFO - Request id 1 done for token 55
2023-05-27 12:53:50,217 - INFO - Request id 2 done for token 55
2023-05-27 12:53:50,356 - INFO - Request id 3 done for token 55
2023-05-27 12:53:50,493 - INFO - Request id 4 done for token 55
2023-05-27 12:53:50,630 - INFO - Request id 5 done for token 55
2023-05-27 12:53:50,792 - INFO - Request id 0 done for token 56
2023-05-27 12:53:50,953 - INFO - Request id 1 done for token 56
2023-05-27 12:53:51,091 - INFO - Request id 2 done for token 56
2023-05-27 12:53:51,230 - INFO - Request id 3 done for token 56
2023-05-27 12:53:51,371 - INFO - Request id 4 done for token 56
2023-05-27 12:53:51,508 - INFO - Request id 5 done for token 56
2023-05-27 12:53:51,670 - INFO - Request id 0 done for token 57
2023-05-27 12:53:51,830 - INFO - Request id 1 done for token 57
2023-05-27 12:53:51,966 - INFO - Request id 2 done for token 57
2023-05-27 12:53:52,103 - INFO - Request id 3 done for token 57
2023-05-27 12:53:52,244 - INFO - Request id 4 done for token 57
2023-05-27 12:53:52,378 - INFO - Request id 5 done for token 57
2023-05-27 12:53:52,541 - INFO - Request id 0 done for token 58
2023-05-27 12:53:52,703 - INFO - Request id 1 done for token 58
2023-05-27 12:53:52,841 - INFO - Request id 2 done for token 58
2023-05-27 12:53:52,981 - INFO - Request id 3 done for token 58
2023-05-27 12:53:53,122 - INFO - Request id 4 done for token 58
2023-05-27 12:53:53,263 - INFO - Request id 5 done for token 58
2023-05-27 12:53:53,428 - INFO - Request id 0 done for token 59
2023-05-27 12:53:53,584 - INFO - Request id 1 done for token 59
2023-05-27 12:53:53,721 - INFO - Request id 2 done for token 59
2023-05-27 12:53:53,859 - INFO - Request id 3 done for token 59
2023-05-27 12:53:53,995 - INFO - Request id 4 done for token 59
2023-05-27 12:53:54,133 - INFO - Request id 5 done for token 59
2023-05-27 12:53:54,293 - INFO - Request id 0 done for token 60
2023-05-27 12:53:54,452 - INFO - Request id 1 done for token 60
2023-05-27 12:53:54,589 - INFO - Request id 2 done for token 60
2023-05-27 12:53:54,727 - INFO - Request id 3 done for token 60
2023-05-27 12:53:54,864 - INFO - Request id 4 done for token 60
2023-05-27 12:53:55,000 - INFO - Request id 5 done for token 60
2023-05-27 12:53:55,161 - INFO - Request id 0 done for token 61
2023-05-27 12:53:55,322 - INFO - Request id 1 done for token 61
2023-05-27 12:53:55,461 - INFO - Request id 2 done for token 61
2023-05-27 12:53:55,601 - INFO - Request id 3 done for token 61
2023-05-27 12:53:55,740 - INFO - Request id 4 done for token 61
2023-05-27 12:53:55,877 - INFO - Request id 5 done for token 61
2023-05-27 12:53:56,037 - INFO - Request id 0 done for token 62
2023-05-27 12:53:56,201 - INFO - Request id 1 done for token 62
2023-05-27 12:53:56,336 - INFO - Request id 2 done for token 62
2023-05-27 12:53:56,476 - INFO - Request id 3 done for token 62
2023-05-27 12:53:56,614 - INFO - Request id 4 done for token 62
2023-05-27 12:53:56,750 - INFO - Request id 5 done for token 62
2023-05-27 12:53:56,912 - INFO - Request id 0 done for token 63
2023-05-27 12:53:57,074 - INFO - Request id 1 done for token 63
2023-05-27 12:53:57,216 - INFO - Request id 2 done for token 63
2023-05-27 12:53:57,351 - INFO - Request id 3 done for token 63
2023-05-27 12:53:57,489 - INFO - Request id 4 done for token 63
2023-05-27 12:53:57,630 - INFO - Request id 5 done for token 63
2023-05-27 12:53:57,787 - INFO - Request id 0 done for token 64
2023-05-27 12:53:57,949 - INFO - Request id 1 done for token 64
2023-05-27 12:53:58,089 - INFO - Request id 2 done for token 64
2023-05-27 12:53:58,224 - INFO - Request id 3 done for token 64
2023-05-27 12:53:58,361 - INFO - Request id 4 done for token 64
2023-05-27 12:53:58,499 - INFO - Request id 5 done for token 64
2023-05-27 12:53:58,659 - INFO - Request id 0 done for token 65
2023-05-27 12:53:58,821 - INFO - Request id 1 done for token 65
2023-05-27 12:53:58,958 - INFO - Request id 2 done for token 65
2023-05-27 12:53:59,096 - INFO - Request id 3 done for token 65
2023-05-27 12:53:59,234 - INFO - Request id 4 done for token 65
2023-05-27 12:53:59,374 - INFO - Request id 5 done for token 65
2023-05-27 12:53:59,535 - INFO - Request id 0 done for token 66
2023-05-27 12:53:59,696 - INFO - Request id 1 done for token 66
2023-05-27 12:53:59,836 - INFO - Request id 2 done for token 66
2023-05-27 12:53:59,973 - INFO - Request id 3 done for token 66
2023-05-27 12:54:00,110 - INFO - Request id 4 done for token 66
2023-05-27 12:54:00,246 - INFO - Request id 5 done for token 66
2023-05-27 12:54:00,407 - INFO - Request id 0 done for token 67
2023-05-27 12:54:00,568 - INFO - Request id 1 done for token 67
2023-05-27 12:54:00,708 - INFO - Request id 2 done for token 67
2023-05-27 12:54:00,846 - INFO - Request id 3 done for token 67
2023-05-27 12:54:00,982 - INFO - Request id 4 done for token 67
2023-05-27 12:54:01,119 - INFO - Request id 5 done for token 67
2023-05-27 12:54:01,282 - INFO - Request id 0 done for token 68
2023-05-27 12:54:01,444 - INFO - Request id 1 done for token 68
2023-05-27 12:54:01,583 - INFO - Request id 2 done for token 68
2023-05-27 12:54:01,722 - INFO - Request id 3 done for token 68
2023-05-27 12:54:01,858 - INFO - Request id 4 done for token 68
2023-05-27 12:54:01,996 - INFO - Request id 5 done for token 68
2023-05-27 12:54:02,157 - INFO - Request id 0 done for token 69
2023-05-27 12:54:02,319 - INFO - Request id 1 done for token 69
2023-05-27 12:54:02,459 - INFO - Request id 2 done for token 69
2023-05-27 12:54:02,596 - INFO - Request id 3 done for token 69
2023-05-27 12:54:02,732 - INFO - Request id 4 done for token 69
2023-05-27 12:54:02,872 - INFO - Request id 5 done for token 69
2023-05-27 12:54:03,034 - INFO - Request id 0 done for token 70
2023-05-27 12:54:03,195 - INFO - Request id 1 done for token 70
2023-05-27 12:54:03,334 - INFO - Request id 2 done for token 70
2023-05-27 12:54:03,473 - INFO - Request id 3 done for token 70
2023-05-27 12:54:03,610 - INFO - Request id 4 done for token 70
2023-05-27 12:54:03,750 - INFO - Request id 5 done for token 70
2023-05-27 12:54:03,910 - INFO - Request id 0 done for token 71
2023-05-27 12:54:04,071 - INFO - Request id 1 done for token 71
2023-05-27 12:54:04,210 - INFO - Request id 2 done for token 71
2023-05-27 12:54:04,348 - INFO - Request id 3 done for token 71
2023-05-27 12:54:04,486 - INFO - Request id 4 done for token 71
2023-05-27 12:54:04,625 - INFO - Request id 5 done for token 71
2023-05-27 12:54:04,785 - INFO - Request id 0 done for token 72
2023-05-27 12:54:04,948 - INFO - Request id 1 done for token 72
2023-05-27 12:54:05,086 - INFO - Request id 2 done for token 72
2023-05-27 12:54:05,224 - INFO - Request id 3 done for token 72
2023-05-27 12:54:05,362 - INFO - Request id 4 done for token 72
2023-05-27 12:54:05,514 - INFO - Request id 5 done for token 72
2023-05-27 12:54:05,665 - INFO - Request id 0 done for token 73
2023-05-27 12:54:05,825 - INFO - Request id 1 done for token 73
2023-05-27 12:54:05,963 - INFO - Request id 2 done for token 73
2023-05-27 12:54:06,102 - INFO - Request id 3 done for token 73
2023-05-27 12:54:06,241 - INFO - Request id 4 done for token 73
2023-05-27 12:54:06,377 - INFO - Request id 5 done for token 73
2023-05-27 12:54:06,539 - INFO - Request id 0 done for token 74
2023-05-27 12:54:06,702 - INFO - Request id 1 done for token 74
2023-05-27 12:54:06,844 - INFO - Request id 2 done for token 74
2023-05-27 12:54:06,981 - INFO - Request id 3 done for token 74
2023-05-27 12:54:07,118 - INFO - Request id 4 done for token 74
2023-05-27 12:54:07,256 - INFO - Request id 5 done for token 74
2023-05-27 12:54:07,418 - INFO - Request id 0 done for token 75
2023-05-27 12:54:07,579 - INFO - Request id 1 done for token 75
2023-05-27 12:54:07,734 - INFO - Request id 2 done for token 75
2023-05-27 12:54:07,855 - INFO - Request id 3 done for token 75
2023-05-27 12:54:07,994 - INFO - Request id 4 done for token 75
2023-05-27 12:54:08,133 - INFO - Request id 5 done for token 75
2023-05-27 12:54:08,293 - INFO - Request id 0 done for token 76
2023-05-27 12:54:08,453 - INFO - Request id 1 done for token 76
2023-05-27 12:54:08,592 - INFO - Request id 2 done for token 76
2023-05-27 12:54:08,730 - INFO - Request id 3 done for token 76
2023-05-27 12:54:08,867 - INFO - Request id 4 done for token 76
2023-05-27 12:54:09,005 - INFO - Request id 5 done for token 76
2023-05-27 12:54:09,167 - INFO - Request id 0 done for token 77
2023-05-27 12:54:09,332 - INFO - Request id 1 done for token 77
2023-05-27 12:54:09,469 - INFO - Request id 2 done for token 77
2023-05-27 12:54:09,606 - INFO - Request id 3 done for token 77
2023-05-27 12:54:09,744 - INFO - Request id 4 done for token 77
2023-05-27 12:54:09,884 - INFO - Request id 5 done for token 77
2023-05-27 12:54:10,046 - INFO - Request id 0 done for token 78
2023-05-27 12:54:10,209 - INFO - Request id 1 done for token 78
2023-05-27 12:54:10,348 - INFO - Request id 2 done for token 78
2023-05-27 12:54:10,486 - INFO - Request id 3 done for token 78
2023-05-27 12:54:10,626 - INFO - Request id 4 done for token 78
2023-05-27 12:54:10,763 - INFO - Request id 5 done for token 78
2023-05-27 12:54:10,924 - INFO - Request id 0 done for token 79
2023-05-27 12:54:11,085 - INFO - Request id 1 done for token 79
2023-05-27 12:54:11,224 - INFO - Request id 2 done for token 79
2023-05-27 12:54:11,373 - INFO - Request id 3 done for token 79
2023-05-27 12:54:11,501 - INFO - Request id 4 done for token 79
2023-05-27 12:54:11,640 - INFO - Request id 5 done for token 79
2023-05-27 12:54:12,508 - INFO - Latency is 713.908646, throughput is 0.044824
2023-05-27 12:54:12,508 - INFO - Token throughput is 3.585893
2023-05-27 12:54:12,529 - INFO - handle_cmd: stop
2023-05-27 12:54:12,549 - INFO - handle_cmd: stop
2023-05-27 12:54:12,565 - INFO - handle_cmd: stop
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /opt/tiger/launch/qsync/QPipe/tests/main_p2p.py:328 in <module>                                  │
│                                                                                                  │
│   325 │   │   model_pre_and_post = model_pre_and_post.cuda()                                     │
│   326 │                                                                                          │
│   327 │   run_pipeline_p2p(loaded_llm_cpu, dist_cfg, sharding_strategy=sharding_strategy)        │
│ ❱ 328 │   simple_queue_thread.join()                                                             │
│   329 │   # from torch import profiler                                                           │
│   330 │   # from torch.profiler import profile, record_function, ProfilerActivity                │
│   331 │   # with profiler.profile(activities=[ProfilerActivity.CPU, ProfilerActivity.CUDA], wi   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'NoneType' object has no attribute 'join'
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /opt/tiger/launch/qsync/QPipe/tests/main_p2p.py:328 in <module>                                  │
│                                                                                                  │
│   325 │   │   model_pre_and_post = model_pre_and_post.cuda()                                     │
│   326 │                                                                                          │
│   327 │   run_pipeline_p2p(loaded_llm_cpu, dist_cfg, sharding_strategy=sharding_strategy)        │
│ ❱ 328 │   simple_queue_thread.join()                                                             │
│   329 │   # from torch import profiler                                                           │
│   330 │   # from torch.profiler import profile, record_function, ProfilerActivity                │
│   331 │   # with profiler.profile(activities=[ProfilerActivity.CPU, ProfilerActivity.CUDA], wi   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'NoneType' object has no attribute 'join'
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /opt/tiger/launch/qsync/QPipe/tests/main_p2p.py:328 in <module>                                  │
│                                                                                                  │
│   325 │   │   model_pre_and_post = model_pre_and_post.cuda()                                     │
│   326 │                                                                                          │
│   327 │   run_pipeline_p2p(loaded_llm_cpu, dist_cfg, sharding_strategy=sharding_strategy)        │
│ ❱ 328 │   simple_queue_thread.join()                                                             │
│   329 │   # from torch import profiler                                                           │
│   330 │   # from torch.profiler import profile, record_function, ProfilerActivity                │
│   331 │   # with profiler.profile(activities=[ProfilerActivity.CPU, ProfilerActivity.CUDA], wi   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'NoneType' object has no attribute 'join'
Exception in thread Thread-501:
Traceback (most recent call last):
  File "/usr/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/home/tiger/.local/lib/python3.9/site-packages/qpipe/p2p/util.py", line 24, in run
    self._req.wait()
RuntimeError: [../third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.128.99.84]:40848
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 181627 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 181628) of binary: /usr/bin/python3
Traceback (most recent call last):
  File "/usr/local/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main_p2p.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-05-27_12:54:18
  host      : n132-166-021.byted.org
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 181629)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-05-27_12:54:18
  host      : n132-166-021.byted.org
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 181630)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-05-27_12:54:18
  host      : n132-166-021.byted.org
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 181628)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
