
===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117_nocublaslt.so
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/nvidia/lib64'), PosixPath('/usr/local/nvidia/lib')}
  warn(msg)
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /usr/local/nvidia/lib:/usr/local/nvidia/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
bin /opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/tmp/torchelastic_xmean4cv/none_eikixq7s/attempt_0/1/error.json')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/opt/conda/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117_nocublaslt.so
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 6.0
CUDA SETUP: Detected CUDA version 117
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: Compute capability < 7.5 detected! Only slow 8-bit matmul is supported for your GPU!
  warn(msg)
CUDA SETUP: Loading binary /opt/conda/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117_nocublaslt.so...
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/nvidia/lib'), PosixPath('/usr/local/nvidia/lib64')}
  warn(msg)
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /usr/local/nvidia/lib:/usr/local/nvidia/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/tmp/torchelastic_xmean4cv/none_eikixq7s/attempt_0/0/error.json')}
  warn(msg)
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 6.0
CUDA SETUP: Detected CUDA version 117
/opt/conda/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: Compute capability < 7.5 detected! Only slow 8-bit matmul is supported for your GPU!
  warn(msg)
CUDA SETUP: Loading binary /opt/conda/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117_nocublaslt.so...
rank 1 is in stage 1
Pipeline Data Loaded, with prefill cnts:  4
rank 0 is in stage 0
create layer: 8|create layer: 0|create layer: 9|create layer: 1|create layer: 10|create layer: 2|create layer: 11|create layer: 3|create layer: 12|create layer: 4|create layer: 13|create layer: 5|create layer: 14|create layer: 6|create layer: 7|create layer: 15|Stage 0 module sharded
Stage 0 kv initialized
Stage 1 module sharded
Stage 1 kv initialized
rank_src: 0, rank_dst: 2, rank: 1, results_cb: None
rank_src: 3, rank_dst: 1, rank: 0, results_cb: <function handle_results at 0x7fcb0d003d90>
2023-06-05 04:16:26,152 - INFO - start pipe data
2023-06-05 04:19:52,423 - INFO - Request id 0 done for token 1
2023-06-05 04:20:45,857 - INFO - Request id 1 done for token 1
2023-06-05 04:21:39,249 - INFO - Request id 2 done for token 1
2023-06-05 04:22:35,208 - INFO - Request id 3 done for token 1
2023-06-05 04:22:36,278 - INFO - Latency is 370.126041, throughput is 0.086457
2023-06-05 04:22:36,279 - INFO - Token throughput is 0.172914
2023-06-05 04:22:46,293 - INFO - start pipe data
2023-06-05 04:26:16,945 - INFO - Request id 0 done for token 1
2023-06-05 04:27:04,651 - INFO - Request id 1 done for token 1
2023-06-05 04:28:04,845 - INFO - Request id 2 done for token 1
2023-06-05 04:29:07,786 - INFO - Request id 3 done for token 1
2023-06-05 04:29:08,252 - INFO - Request id 0 done for token 2
2023-06-05 04:29:08,270 - INFO - Request id 1 done for token 2
2023-06-05 04:29:08,292 - INFO - Request id 2 done for token 2
2023-06-05 04:29:08,876 - INFO - Request id 3 done for token 2
2023-06-05 04:29:09,021 - INFO - Request id 0 done for token 3
2023-06-05 04:29:09,162 - INFO - Request id 1 done for token 3
2023-06-05 04:29:09,304 - INFO - Request id 2 done for token 3
2023-06-05 04:29:09,452 - INFO - Request id 3 done for token 3
2023-06-05 04:29:09,597 - INFO - Request id 0 done for token 4
2023-06-05 04:29:09,741 - INFO - Request id 1 done for token 4
2023-06-05 04:29:09,885 - INFO - Request id 2 done for token 4
2023-06-05 04:29:10,025 - INFO - Request id 3 done for token 4
2023-06-05 04:29:10,169 - INFO - Request id 0 done for token 5
2023-06-05 04:29:10,312 - INFO - Request id 1 done for token 5
2023-06-05 04:29:10,459 - INFO - Request id 2 done for token 5
2023-06-05 04:29:10,602 - INFO - Request id 3 done for token 5
2023-06-05 04:29:10,747 - INFO - Request id 0 done for token 6
2023-06-05 04:29:10,890 - INFO - Request id 1 done for token 6
2023-06-05 04:29:11,033 - INFO - Request id 2 done for token 6
2023-06-05 04:29:11,175 - INFO - Request id 3 done for token 6
2023-06-05 04:29:11,320 - INFO - Request id 0 done for token 7
2023-06-05 04:29:11,465 - INFO - Request id 1 done for token 7
2023-06-05 04:29:11,607 - INFO - Request id 2 done for token 7
2023-06-05 04:29:11,751 - INFO - Request id 3 done for token 7
2023-06-05 04:29:11,893 - INFO - Request id 0 done for token 8
2023-06-05 04:29:12,038 - INFO - Request id 1 done for token 8
2023-06-05 04:29:12,182 - INFO - Request id 2 done for token 8
2023-06-05 04:29:12,325 - INFO - Request id 3 done for token 8
2023-06-05 04:29:12,467 - INFO - Request id 0 done for token 9
2023-06-05 04:29:12,609 - INFO - Request id 1 done for token 9
2023-06-05 04:29:12,752 - INFO - Request id 2 done for token 9
2023-06-05 04:29:12,896 - INFO - Request id 3 done for token 9
2023-06-05 04:29:13,040 - INFO - Request id 0 done for token 10
2023-06-05 04:29:13,182 - INFO - Request id 1 done for token 10
2023-06-05 04:29:13,330 - INFO - Request id 2 done for token 10
2023-06-05 04:29:13,474 - INFO - Request id 3 done for token 10
2023-06-05 04:29:13,618 - INFO - Request id 0 done for token 11
2023-06-05 04:29:13,761 - INFO - Request id 1 done for token 11
2023-06-05 04:29:13,905 - INFO - Request id 2 done for token 11
2023-06-05 04:29:14,047 - INFO - Request id 3 done for token 11
2023-06-05 04:29:14,192 - INFO - Request id 0 done for token 12
2023-06-05 04:29:14,335 - INFO - Request id 1 done for token 12
2023-06-05 04:29:14,480 - INFO - Request id 2 done for token 12
2023-06-05 04:29:14,624 - INFO - Request id 3 done for token 12
2023-06-05 04:29:14,768 - INFO - Request id 0 done for token 13
2023-06-05 04:29:14,909 - INFO - Request id 1 done for token 13
2023-06-05 04:29:15,053 - INFO - Request id 2 done for token 13
2023-06-05 04:29:15,196 - INFO - Request id 3 done for token 13
2023-06-05 04:29:15,342 - INFO - Request id 0 done for token 14
2023-06-05 04:29:15,485 - INFO - Request id 1 done for token 14
2023-06-05 04:29:15,630 - INFO - Request id 2 done for token 14
2023-06-05 04:29:15,772 - INFO - Request id 3 done for token 14
2023-06-05 04:29:15,916 - INFO - Request id 0 done for token 15
2023-06-05 04:29:16,063 - INFO - Request id 1 done for token 15
2023-06-05 04:29:16,206 - INFO - Request id 2 done for token 15
2023-06-05 04:29:16,350 - INFO - Request id 3 done for token 15
2023-06-05 04:29:16,495 - INFO - Request id 0 done for token 16
2023-06-05 04:29:16,638 - INFO - Request id 1 done for token 16
2023-06-05 04:29:16,783 - INFO - Request id 2 done for token 16
2023-06-05 04:29:16,929 - INFO - Request id 3 done for token 16
2023-06-05 04:29:17,071 - INFO - Request id 0 done for token 17
2023-06-05 04:29:17,217 - INFO - Request id 1 done for token 17
2023-06-05 04:29:17,360 - INFO - Request id 2 done for token 17
2023-06-05 04:29:17,504 - INFO - Request id 3 done for token 17
2023-06-05 04:29:17,646 - INFO - Request id 0 done for token 18
2023-06-05 04:29:17,794 - INFO - Request id 1 done for token 18
2023-06-05 04:29:17,936 - INFO - Request id 2 done for token 18
2023-06-05 04:29:18,081 - INFO - Request id 3 done for token 18
2023-06-05 04:29:18,226 - INFO - Request id 0 done for token 19
2023-06-05 04:29:18,369 - INFO - Request id 1 done for token 19
2023-06-05 04:29:18,514 - INFO - Request id 2 done for token 19
2023-06-05 04:29:18,657 - INFO - Request id 3 done for token 19
2023-06-05 04:29:18,802 - INFO - Request id 0 done for token 20
2023-06-05 04:29:18,947 - INFO - Request id 1 done for token 20
2023-06-05 04:29:19,093 - INFO - Request id 2 done for token 20
2023-06-05 04:29:19,235 - INFO - Request id 3 done for token 20
2023-06-05 04:29:19,378 - INFO - Request id 0 done for token 21
2023-06-05 04:29:19,524 - INFO - Request id 1 done for token 21
2023-06-05 04:29:19,667 - INFO - Request id 2 done for token 21
2023-06-05 04:29:19,813 - INFO - Request id 3 done for token 21
2023-06-05 04:29:19,956 - INFO - Request id 0 done for token 22
2023-06-05 04:29:20,102 - INFO - Request id 1 done for token 22
2023-06-05 04:29:20,245 - INFO - Request id 2 done for token 22
2023-06-05 04:29:20,392 - INFO - Request id 3 done for token 22
2023-06-05 04:29:20,535 - INFO - Request id 0 done for token 23
2023-06-05 04:29:20,681 - INFO - Request id 1 done for token 23
2023-06-05 04:29:20,825 - INFO - Request id 2 done for token 23
2023-06-05 04:29:20,972 - INFO - Request id 3 done for token 23
2023-06-05 04:29:21,114 - INFO - Request id 0 done for token 24
2023-06-05 04:29:21,259 - INFO - Request id 1 done for token 24
2023-06-05 04:29:21,406 - INFO - Request id 2 done for token 24
2023-06-05 04:29:21,550 - INFO - Request id 3 done for token 24
2023-06-05 04:29:21,695 - INFO - Request id 0 done for token 25
2023-06-05 04:29:21,838 - INFO - Request id 1 done for token 25
2023-06-05 04:29:21,985 - INFO - Request id 2 done for token 25
2023-06-05 04:29:22,128 - INFO - Request id 3 done for token 25
2023-06-05 04:29:22,275 - INFO - Request id 0 done for token 26
2023-06-05 04:29:22,418 - INFO - Request id 1 done for token 26
2023-06-05 04:29:22,567 - INFO - Request id 2 done for token 26
2023-06-05 04:29:22,710 - INFO - Request id 3 done for token 26
2023-06-05 04:29:22,856 - INFO - Request id 0 done for token 27
2023-06-05 04:29:23,000 - INFO - Request id 1 done for token 27
2023-06-05 04:29:23,149 - INFO - Request id 2 done for token 27
2023-06-05 04:29:23,292 - INFO - Request id 3 done for token 27
2023-06-05 04:29:23,434 - INFO - Request id 0 done for token 28
2023-06-05 04:29:23,580 - INFO - Request id 1 done for token 28
2023-06-05 04:29:23,725 - INFO - Request id 2 done for token 28
2023-06-05 04:29:23,872 - INFO - Request id 3 done for token 28
2023-06-05 04:29:24,016 - INFO - Request id 0 done for token 29
2023-06-05 04:29:24,160 - INFO - Request id 1 done for token 29
2023-06-05 04:29:24,303 - INFO - Request id 2 done for token 29
2023-06-05 04:29:24,451 - INFO - Request id 3 done for token 29
2023-06-05 04:29:24,593 - INFO - Request id 0 done for token 30
2023-06-05 04:29:24,740 - INFO - Request id 1 done for token 30
2023-06-05 04:29:24,884 - INFO - Request id 2 done for token 30
2023-06-05 04:29:25,030 - INFO - Request id 3 done for token 30
2023-06-05 04:29:25,174 - INFO - Request id 0 done for token 31
2023-06-05 04:29:25,321 - INFO - Request id 1 done for token 31
2023-06-05 04:29:25,464 - INFO - Request id 2 done for token 31
2023-06-05 04:29:25,611 - INFO - Request id 3 done for token 31
2023-06-05 04:29:25,761 - INFO - Request id 0 done for token 32
2023-06-05 04:29:25,904 - INFO - Request id 1 done for token 32
2023-06-05 04:29:26,048 - INFO - Request id 2 done for token 32
2023-06-05 04:29:26,191 - INFO - Request id 3 done for token 32
2023-06-05 04:29:26,338 - INFO - Request id 0 done for token 33
2023-06-05 04:29:26,482 - INFO - Request id 1 done for token 33
2023-06-05 04:29:26,628 - INFO - Request id 2 done for token 33
2023-06-05 04:29:26,771 - INFO - Request id 3 done for token 33
2023-06-05 04:29:26,917 - INFO - Request id 0 done for token 34
2023-06-05 04:29:27,064 - INFO - Request id 1 done for token 34
2023-06-05 04:29:27,208 - INFO - Request id 2 done for token 34
2023-06-05 04:29:27,352 - INFO - Request id 3 done for token 34
2023-06-05 04:29:27,496 - INFO - Request id 0 done for token 35
2023-06-05 04:29:27,643 - INFO - Request id 1 done for token 35
2023-06-05 04:29:27,789 - INFO - Request id 2 done for token 35
2023-06-05 04:29:27,932 - INFO - Request id 3 done for token 35
2023-06-05 04:29:28,076 - INFO - Request id 0 done for token 36
2023-06-05 04:29:28,219 - INFO - Request id 1 done for token 36
2023-06-05 04:29:28,366 - INFO - Request id 2 done for token 36
2023-06-05 04:29:28,513 - INFO - Request id 3 done for token 36
2023-06-05 04:29:28,658 - INFO - Request id 0 done for token 37
2023-06-05 04:29:28,805 - INFO - Request id 1 done for token 37
2023-06-05 04:29:28,949 - INFO - Request id 2 done for token 37
2023-06-05 04:29:29,094 - INFO - Request id 3 done for token 37
2023-06-05 04:29:29,241 - INFO - Request id 0 done for token 38
2023-06-05 04:29:29,386 - INFO - Request id 1 done for token 38
2023-06-05 04:29:29,530 - INFO - Request id 2 done for token 38
2023-06-05 04:29:29,675 - INFO - Request id 3 done for token 38
2023-06-05 04:29:29,821 - INFO - Request id 0 done for token 39
2023-06-05 04:29:29,965 - INFO - Request id 1 done for token 39
2023-06-05 04:29:30,112 - INFO - Request id 2 done for token 39
2023-06-05 04:29:30,255 - INFO - Request id 3 done for token 39
2023-06-05 04:29:30,400 - INFO - Request id 0 done for token 40
2023-06-05 04:29:30,546 - INFO - Request id 1 done for token 40
2023-06-05 04:29:30,693 - INFO - Request id 2 done for token 40
2023-06-05 04:29:30,838 - INFO - Request id 3 done for token 40
2023-06-05 04:29:30,981 - INFO - Request id 0 done for token 41
2023-06-05 04:29:31,126 - INFO - Request id 1 done for token 41
2023-06-05 04:29:31,275 - INFO - Request id 2 done for token 41
2023-06-05 04:29:31,418 - INFO - Request id 3 done for token 41
2023-06-05 04:29:31,564 - INFO - Request id 0 done for token 42
2023-06-05 04:29:31,710 - INFO - Request id 1 done for token 42
2023-06-05 04:29:31,857 - INFO - Request id 2 done for token 42
2023-06-05 04:29:32,002 - INFO - Request id 3 done for token 42
2023-06-05 04:29:32,149 - INFO - Request id 0 done for token 43
2023-06-05 04:29:32,292 - INFO - Request id 1 done for token 43
2023-06-05 04:29:32,440 - INFO - Request id 2 done for token 43
2023-06-05 04:29:32,584 - INFO - Request id 3 done for token 43
2023-06-05 04:29:32,732 - INFO - Request id 0 done for token 44
2023-06-05 04:29:32,876 - INFO - Request id 1 done for token 44
2023-06-05 04:29:33,025 - INFO - Request id 2 done for token 44
2023-06-05 04:29:33,172 - INFO - Request id 3 done for token 44
2023-06-05 04:29:33,317 - INFO - Request id 0 done for token 45
2023-06-05 04:29:33,461 - INFO - Request id 1 done for token 45
2023-06-05 04:29:33,608 - INFO - Request id 2 done for token 45
2023-06-05 04:29:33,754 - INFO - Request id 3 done for token 45
2023-06-05 04:29:33,902 - INFO - Request id 0 done for token 46
2023-06-05 04:29:34,046 - INFO - Request id 1 done for token 46
2023-06-05 04:29:34,192 - INFO - Request id 2 done for token 46
2023-06-05 04:29:34,338 - INFO - Request id 3 done for token 46
2023-06-05 04:29:34,487 - INFO - Request id 0 done for token 47
2023-06-05 04:29:34,633 - INFO - Request id 1 done for token 47
2023-06-05 04:29:34,780 - INFO - Request id 2 done for token 47
2023-06-05 04:29:34,923 - INFO - Request id 3 done for token 47
2023-06-05 04:29:35,069 - INFO - Request id 0 done for token 48
2023-06-05 04:29:35,216 - INFO - Request id 1 done for token 48
2023-06-05 04:29:35,364 - INFO - Request id 2 done for token 48
2023-06-05 04:29:35,507 - INFO - Request id 3 done for token 48
2023-06-05 04:29:35,654 - INFO - Request id 0 done for token 49
2023-06-05 04:29:35,798 - INFO - Request id 1 done for token 49
2023-06-05 04:29:35,941 - INFO - Request id 2 done for token 49
2023-06-05 04:29:36,090 - INFO - Request id 3 done for token 49
2023-06-05 04:29:36,235 - INFO - Request id 0 done for token 50
2023-06-05 04:29:36,381 - INFO - Request id 1 done for token 50
2023-06-05 04:29:36,525 - INFO - Request id 2 done for token 50
2023-06-05 04:29:36,674 - INFO - Request id 3 done for token 50
2023-06-05 04:29:36,818 - INFO - Request id 0 done for token 51
2023-06-05 04:29:36,963 - INFO - Request id 1 done for token 51
2023-06-05 04:29:37,107 - INFO - Request id 2 done for token 51
2023-06-05 04:29:37,253 - INFO - Request id 3 done for token 51
2023-06-05 04:29:37,401 - INFO - Request id 0 done for token 52
2023-06-05 04:29:37,546 - INFO - Request id 1 done for token 52
2023-06-05 04:29:37,691 - INFO - Request id 2 done for token 52
2023-06-05 04:29:37,839 - INFO - Request id 3 done for token 52
2023-06-05 04:29:37,983 - INFO - Request id 0 done for token 53
2023-06-05 04:29:38,127 - INFO - Request id 1 done for token 53
2023-06-05 04:29:38,272 - INFO - Request id 2 done for token 53
2023-06-05 04:29:38,419 - INFO - Request id 3 done for token 53
2023-06-05 04:29:38,566 - INFO - Request id 0 done for token 54
2023-06-05 04:29:38,713 - INFO - Request id 1 done for token 54
2023-06-05 04:29:38,859 - INFO - Request id 2 done for token 54
2023-06-05 04:29:39,004 - INFO - Request id 3 done for token 54
2023-06-05 04:29:39,149 - INFO - Request id 0 done for token 55
2023-06-05 04:29:39,293 - INFO - Request id 1 done for token 55
2023-06-05 04:29:39,440 - INFO - Request id 2 done for token 55
2023-06-05 04:29:39,586 - INFO - Request id 3 done for token 55
2023-06-05 04:29:39,733 - INFO - Request id 0 done for token 56
2023-06-05 04:29:39,877 - INFO - Request id 1 done for token 56
2023-06-05 04:29:40,025 - INFO - Request id 2 done for token 56
2023-06-05 04:29:40,170 - INFO - Request id 3 done for token 56
2023-06-05 04:29:40,313 - INFO - Request id 0 done for token 57
2023-06-05 04:29:40,458 - INFO - Request id 1 done for token 57
2023-06-05 04:29:40,604 - INFO - Request id 2 done for token 57
2023-06-05 04:29:40,752 - INFO - Request id 3 done for token 57
2023-06-05 04:29:40,900 - INFO - Request id 0 done for token 58
2023-06-05 04:29:41,045 - INFO - Request id 1 done for token 58
2023-06-05 04:29:41,189 - INFO - Request id 2 done for token 58
2023-06-05 04:29:41,336 - INFO - Request id 3 done for token 58
2023-06-05 04:29:41,483 - INFO - Request id 0 done for token 59
2023-06-05 04:29:41,629 - INFO - Request id 1 done for token 59
2023-06-05 04:29:41,773 - INFO - Request id 2 done for token 59
2023-06-05 04:29:41,921 - INFO - Request id 3 done for token 59
2023-06-05 04:29:42,065 - INFO - Request id 0 done for token 60
2023-06-05 04:29:42,213 - INFO - Request id 1 done for token 60
2023-06-05 04:29:42,359 - INFO - Request id 2 done for token 60
2023-06-05 04:29:42,503 - INFO - Request id 3 done for token 60
2023-06-05 04:29:42,649 - INFO - Request id 0 done for token 61
2023-06-05 04:29:42,795 - INFO - Request id 1 done for token 61
2023-06-05 04:29:42,943 - INFO - Request id 2 done for token 61
2023-06-05 04:29:43,087 - INFO - Request id 3 done for token 61
2023-06-05 04:29:43,235 - INFO - Request id 0 done for token 62
2023-06-05 04:29:43,380 - INFO - Request id 1 done for token 62
2023-06-05 04:29:43,526 - INFO - Request id 2 done for token 62
2023-06-05 04:29:43,673 - INFO - Request id 3 done for token 62
2023-06-05 04:29:43,823 - INFO - Request id 0 done for token 63
2023-06-05 04:29:43,968 - INFO - Request id 1 done for token 63
2023-06-05 04:29:44,114 - INFO - Request id 2 done for token 63
2023-06-05 04:29:44,261 - INFO - Request id 3 done for token 63
2023-06-05 04:29:44,405 - INFO - Request id 0 done for token 64
2023-06-05 04:29:44,555 - INFO - Request id 1 done for token 64
2023-06-05 04:29:44,699 - INFO - Request id 2 done for token 64
2023-06-05 04:29:44,846 - INFO - Request id 3 done for token 64
2023-06-05 04:29:44,991 - INFO - Request id 0 done for token 65
2023-06-05 04:29:45,137 - INFO - Request id 1 done for token 65
2023-06-05 04:29:45,282 - INFO - Request id 2 done for token 65
2023-06-05 04:29:45,430 - INFO - Request id 3 done for token 65
2023-06-05 04:29:45,577 - INFO - Request id 0 done for token 66
2023-06-05 04:29:45,723 - INFO - Request id 1 done for token 66
2023-06-05 04:29:45,868 - INFO - Request id 2 done for token 66
2023-06-05 04:29:46,013 - INFO - Request id 3 done for token 66
2023-06-05 04:29:46,161 - INFO - Request id 0 done for token 67
2023-06-05 04:29:46,306 - INFO - Request id 1 done for token 67
2023-06-05 04:29:46,455 - INFO - Request id 2 done for token 67
2023-06-05 04:29:46,600 - INFO - Request id 3 done for token 67
2023-06-05 04:29:46,747 - INFO - Request id 0 done for token 68
2023-06-05 04:29:46,893 - INFO - Request id 1 done for token 68
2023-06-05 04:29:47,041 - INFO - Request id 2 done for token 68
2023-06-05 04:29:47,186 - INFO - Request id 3 done for token 68
2023-06-05 04:29:47,332 - INFO - Request id 0 done for token 69
2023-06-05 04:29:47,477 - INFO - Request id 1 done for token 69
2023-06-05 04:29:47,626 - INFO - Request id 2 done for token 69
2023-06-05 04:29:47,771 - INFO - Request id 3 done for token 69
2023-06-05 04:29:47,917 - INFO - Request id 0 done for token 70
2023-06-05 04:29:48,062 - INFO - Request id 1 done for token 70
2023-06-05 04:29:48,211 - INFO - Request id 2 done for token 70
2023-06-05 04:29:48,358 - INFO - Request id 3 done for token 70
2023-06-05 04:29:48,505 - INFO - Request id 0 done for token 71
2023-06-05 04:29:48,652 - INFO - Request id 1 done for token 71
2023-06-05 04:29:48,798 - INFO - Request id 2 done for token 71
2023-06-05 04:29:48,944 - INFO - Request id 3 done for token 71
2023-06-05 04:29:49,089 - INFO - Request id 0 done for token 72
2023-06-05 04:29:49,238 - INFO - Request id 1 done for token 72
2023-06-05 04:29:49,388 - INFO - Request id 2 done for token 72
2023-06-05 04:29:49,534 - INFO - Request id 3 done for token 72
2023-06-05 04:29:49,682 - INFO - Request id 0 done for token 73
2023-06-05 04:29:49,829 - INFO - Request id 1 done for token 73
2023-06-05 04:29:49,974 - INFO - Request id 2 done for token 73
2023-06-05 04:29:50,126 - INFO - Request id 3 done for token 73
2023-06-05 04:29:50,272 - INFO - Request id 0 done for token 74
2023-06-05 04:29:50,419 - INFO - Request id 1 done for token 74
2023-06-05 04:29:50,565 - INFO - Request id 2 done for token 74
2023-06-05 04:29:50,714 - INFO - Request id 3 done for token 74
2023-06-05 04:29:50,861 - INFO - Request id 0 done for token 75
2023-06-05 04:29:51,009 - INFO - Request id 1 done for token 75
2023-06-05 04:29:51,153 - INFO - Request id 2 done for token 75
2023-06-05 04:29:51,302 - INFO - Request id 3 done for token 75
2023-06-05 04:29:51,447 - INFO - Request id 0 done for token 76
2023-06-05 04:29:51,593 - INFO - Request id 1 done for token 76
2023-06-05 04:29:51,739 - INFO - Request id 2 done for token 76
2023-06-05 04:29:51,890 - INFO - Request id 3 done for token 76
2023-06-05 04:29:52,035 - INFO - Request id 0 done for token 77
2023-06-05 04:29:52,183 - INFO - Request id 1 done for token 77
2023-06-05 04:29:52,328 - INFO - Request id 2 done for token 77
2023-06-05 04:29:52,477 - INFO - Request id 3 done for token 77
2023-06-05 04:29:52,623 - INFO - Request id 0 done for token 78
2023-06-05 04:29:52,769 - INFO - Request id 1 done for token 78
2023-06-05 04:29:52,914 - INFO - Request id 2 done for token 78
2023-06-05 04:29:53,066 - INFO - Request id 3 done for token 78
2023-06-05 04:29:53,216 - INFO - Request id 0 done for token 79
2023-06-05 04:29:53,362 - INFO - Request id 1 done for token 79
2023-06-05 04:29:53,511 - INFO - Request id 2 done for token 79
2023-06-05 04:29:53,656 - INFO - Request id 3 done for token 79
2023-06-05 04:29:53,805 - INFO - Request id 0 done for token 80
2023-06-05 04:29:53,953 - INFO - Request id 1 done for token 80
2023-06-05 04:29:54,099 - INFO - Request id 2 done for token 80
2023-06-05 04:29:54,244 - INFO - Request id 3 done for token 80
2023-06-05 04:29:54,391 - INFO - Request id 0 done for token 81
2023-06-05 04:29:54,544 - INFO - Request id 1 done for token 81
2023-06-05 04:29:54,689 - INFO - Request id 2 done for token 81
2023-06-05 04:29:54,835 - INFO - Request id 3 done for token 81
2023-06-05 04:29:54,982 - INFO - Request id 0 done for token 82
2023-06-05 04:29:55,132 - INFO - Request id 1 done for token 82
2023-06-05 04:29:55,280 - INFO - Request id 2 done for token 82
2023-06-05 04:29:55,427 - INFO - Request id 3 done for token 82
2023-06-05 04:29:55,573 - INFO - Request id 0 done for token 83
2023-06-05 04:29:55,722 - INFO - Request id 1 done for token 83
2023-06-05 04:29:55,868 - INFO - Request id 2 done for token 83
2023-06-05 04:29:56,015 - INFO - Request id 3 done for token 83
2023-06-05 04:29:56,168 - INFO - Request id 0 done for token 84
2023-06-05 04:29:56,314 - INFO - Request id 1 done for token 84
2023-06-05 04:29:56,460 - INFO - Request id 2 done for token 84
2023-06-05 04:29:56,606 - INFO - Request id 3 done for token 84
2023-06-05 04:29:56,762 - INFO - Request id 0 done for token 85
2023-06-05 04:29:56,910 - INFO - Request id 1 done for token 85
2023-06-05 04:29:57,056 - INFO - Request id 2 done for token 85
2023-06-05 04:29:57,202 - INFO - Request id 3 done for token 85
2023-06-05 04:29:57,351 - INFO - Request id 0 done for token 86
2023-06-05 04:29:57,496 - INFO - Request id 1 done for token 86
2023-06-05 04:29:57,646 - INFO - Request id 2 done for token 86
2023-06-05 04:29:57,793 - INFO - Request id 3 done for token 86
2023-06-05 04:29:57,941 - INFO - Request id 0 done for token 87
2023-06-05 04:29:58,087 - INFO - Request id 1 done for token 87
2023-06-05 04:29:58,236 - INFO - Request id 2 done for token 87
2023-06-05 04:29:58,381 - INFO - Request id 3 done for token 87
2023-06-05 04:29:58,532 - INFO - Request id 0 done for token 88
2023-06-05 04:29:58,678 - INFO - Request id 1 done for token 88
2023-06-05 04:29:58,827 - INFO - Request id 2 done for token 88
2023-06-05 04:29:58,972 - INFO - Request id 3 done for token 88
2023-06-05 04:29:59,119 - INFO - Request id 0 done for token 89
2023-06-05 04:29:59,272 - INFO - Request id 1 done for token 89
2023-06-05 04:29:59,419 - INFO - Request id 2 done for token 89
2023-06-05 04:29:59,565 - INFO - Request id 3 done for token 89
2023-06-05 04:29:59,711 - INFO - Request id 0 done for token 90
2023-06-05 04:29:59,859 - INFO - Request id 1 done for token 90
2023-06-05 04:30:00,007 - INFO - Request id 2 done for token 90
2023-06-05 04:30:00,156 - INFO - Request id 3 done for token 90
2023-06-05 04:30:00,302 - INFO - Request id 0 done for token 91
2023-06-05 04:30:00,451 - INFO - Request id 1 done for token 91
2023-06-05 04:30:00,600 - INFO - Request id 2 done for token 91
2023-06-05 04:30:00,752 - INFO - Request id 3 done for token 91
2023-06-05 04:30:00,899 - INFO - Request id 0 done for token 92
2023-06-05 04:30:01,048 - INFO - Request id 1 done for token 92
2023-06-05 04:30:01,193 - INFO - Request id 2 done for token 92
2023-06-05 04:30:01,339 - INFO - Request id 3 done for token 92
2023-06-05 04:30:01,488 - INFO - Request id 0 done for token 93
2023-06-05 04:30:01,638 - INFO - Request id 1 done for token 93
2023-06-05 04:30:01,785 - INFO - Request id 2 done for token 93
2023-06-05 04:30:01,931 - INFO - Request id 3 done for token 93
2023-06-05 04:30:02,079 - INFO - Request id 0 done for token 94
2023-06-05 04:30:02,226 - INFO - Request id 1 done for token 94
2023-06-05 04:30:02,377 - INFO - Request id 2 done for token 94
2023-06-05 04:30:02,526 - INFO - Request id 3 done for token 94
2023-06-05 04:30:02,673 - INFO - Request id 0 done for token 95
2023-06-05 04:30:02,821 - INFO - Request id 1 done for token 95
2023-06-05 04:30:02,968 - INFO - Request id 2 done for token 95
2023-06-05 04:30:03,116 - INFO - Request id 3 done for token 95
2023-06-05 04:30:03,265 - INFO - Request id 0 done for token 96
2023-06-05 04:30:03,413 - INFO - Request id 1 done for token 96
2023-06-05 04:30:03,559 - INFO - Request id 2 done for token 96
2023-06-05 04:30:03,707 - INFO - Request id 3 done for token 96
2023-06-05 04:30:03,854 - INFO - Request id 0 done for token 97
2023-06-05 04:30:04,000 - INFO - Request id 1 done for token 97
2023-06-05 04:30:04,149 - INFO - Request id 2 done for token 97
2023-06-05 04:30:04,299 - INFO - Request id 3 done for token 97
2023-06-05 04:30:04,447 - INFO - Request id 0 done for token 98
2023-06-05 04:30:04,595 - INFO - Request id 1 done for token 98
2023-06-05 04:30:04,743 - INFO - Request id 2 done for token 98
2023-06-05 04:30:04,890 - INFO - Request id 3 done for token 98
2023-06-05 04:30:05,037 - INFO - Request id 0 done for token 99
2023-06-05 04:30:05,186 - INFO - Request id 1 done for token 99
2023-06-05 04:30:05,338 - INFO - Request id 2 done for token 99
2023-06-05 04:30:05,484 - INFO - Request id 3 done for token 99
2023-06-05 04:30:06,069 - INFO - Latency is 439.776188, throughput is 0.072764
2023-06-05 04:30:06,070 - INFO - Token throughput is 7.276429
2023-06-05 04:30:06,163 - INFO - handle_cmd: stop
Traceback (most recent call last):
  File "/workspace/qpipe/tests/main_p2p.py", line 329, in <module>
    simple_queue_thread.join()
AttributeError: 'NoneType' object has no attribute 'join'
Exception in thread Thread-417:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.10/site-packages/qpipe/p2p/util.py", line 24, in run
    self._req.wait()
RuntimeError: [/opt/conda/conda-bld/pytorch_1678411187366/work/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.28.1.27]:4246
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 134582 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 134583) of binary: /opt/conda/bin/python
Traceback (most recent call last):
  File "/opt/conda/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==2.0.0', 'console_scripts', 'torchrun')())
  File "/opt/conda/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/opt/conda/lib/python3.10/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/opt/conda/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/conda/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main_p2p.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-06-05_04:30:07
  host      : net-g1
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 134583)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
