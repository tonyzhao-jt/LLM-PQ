
libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
bin /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tiger/.local/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...

libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS

libgomp: Invalid value for environment variable OMP_NUM_THREADS
rank 2 is in stage 2
rank 3 is in stage 3
rank 1 is in stage 1
Pipeline Data Loaded, with prefill cnts:  4
rank 0 is in stage 0
create layer: 30|create layer: 50|create layer: 10|create layer: 0|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 1|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 31|create layer: 51|create layer: 11|create layer: 2|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 3|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 32|create layer: 52|create layer: 4|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 12|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 5|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 33|create layer: 53|create layer: 13|create layer: 6|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 7|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 34|create layer: 54|create layer: 14|create layer: 8|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
create layer: 9|huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
Stage 0 module sharded
Stage 0 kv initialized
create layer: 35|create layer: 55|create layer: 15|create layer: 36|create layer: 56|create layer: 16|create layer: 37|create layer: 57|create layer: 17|create layer: 38|create layer: 58|create layer: 18|create layer: 39|create layer: 19|create layer: 59|create layer: 40|create layer: 60|create layer: 20|create layer: 41|create layer: 61|create layer: 21|create layer: 42|create layer: 62|create layer: 22|create layer: 43|create layer: 63|create layer: 23|create layer: 44|create layer: 64|create layer: 24|create layer: 45|create layer: 65|create layer: 25|create layer: 46|create layer: 66|create layer: 26|create layer: 47|create layer: 67|create layer: 27|create layer: 48|create layer: 68|create layer: 28|create layer: 49|create layer: 69|create layer: 29|Stage 2 module sharded
Stage 2 kv initialized
Stage 3 module sharded
Stage 3 kv initialized
Stage 1 module sharded
Stage 1 kv initialized
rank_src: 3, rank_dst: 1, rank: 0, results_cb: <function handle_results at 0x7f19eb7aeaf0>rank_src: 1, rank_dst: 3, rank: 2, results_cb: None

rank_src: 2, rank_dst: 0, rank: 3, results_cb: None
rank_src: 0, rank_dst: 2, rank: 1, results_cb: None
2023-05-29 01:03:56,207 - INFO - start pipe data
/home/tiger/.local/lib/python3.9/site-packages/qpipe/p2p/util.py:32: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  byte_storage = torch.ByteStorage.from_buffer(bytes_io.getvalue())  # type: ignore[attr-defined]
/home/tiger/.local/lib/python3.9/site-packages/qpipe/p2p/util.py:32: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  byte_storage = torch.ByteStorage.from_buffer(bytes_io.getvalue())  # type: ignore[attr-defined]
/home/tiger/.local/lib/python3.9/site-packages/qpipe/p2p/util.py:32: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  byte_storage = torch.ByteStorage.from_buffer(bytes_io.getvalue())  # type: ignore[attr-defined]
/home/tiger/.local/lib/python3.9/site-packages/qpipe/p2p/util.py:32: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  byte_storage = torch.ByteStorage.from_buffer(bytes_io.getvalue())  # type: ignore[attr-defined]
2023-05-29 01:04:09,114 - INFO - Request id 0 done for token 1
2023-05-29 01:04:11,396 - INFO - Request id 1 done for token 1
2023-05-29 01:04:13,665 - INFO - Request id 2 done for token 1
2023-05-29 01:04:15,847 - INFO - Request id 3 done for token 1
2023-05-29 01:04:16,925 - INFO - Latency is 20.718154, throughput is 1.544539
2023-05-29 01:04:16,925 - INFO - Token throughput is 3.089078
2023-05-29 01:04:26,937 - INFO - start pipe data
2023-05-29 01:04:35,441 - INFO - Request id 0 done for token 1
2023-05-29 01:04:37,903 - INFO - Request id 1 done for token 1
2023-05-29 01:04:40,198 - INFO - Request id 2 done for token 1
2023-05-29 01:04:42,400 - INFO - Request id 3 done for token 1
2023-05-29 01:04:42,552 - INFO - Request id 0 done for token 2
2023-05-29 01:04:42,851 - INFO - Request id 1 done for token 2
2023-05-29 01:04:43,172 - INFO - Request id 2 done for token 2
2023-05-29 01:04:43,490 - INFO - Request id 3 done for token 2
2023-05-29 01:04:43,809 - INFO - Request id 0 done for token 3
2023-05-29 01:04:44,126 - INFO - Request id 1 done for token 3
2023-05-29 01:04:44,452 - INFO - Request id 2 done for token 3
2023-05-29 01:04:44,772 - INFO - Request id 3 done for token 3
2023-05-29 01:04:45,090 - INFO - Request id 0 done for token 4
2023-05-29 01:04:45,411 - INFO - Request id 1 done for token 4
2023-05-29 01:04:45,731 - INFO - Request id 2 done for token 4
2023-05-29 01:04:46,053 - INFO - Request id 3 done for token 4
2023-05-29 01:04:46,373 - INFO - Request id 0 done for token 5
2023-05-29 01:04:46,691 - INFO - Request id 1 done for token 5
2023-05-29 01:04:47,011 - INFO - Request id 2 done for token 5
2023-05-29 01:04:47,329 - INFO - Request id 3 done for token 5
2023-05-29 01:04:47,646 - INFO - Request id 0 done for token 6
2023-05-29 01:04:47,966 - INFO - Request id 1 done for token 6
2023-05-29 01:04:48,284 - INFO - Request id 2 done for token 6
2023-05-29 01:04:48,602 - INFO - Request id 3 done for token 6
2023-05-29 01:04:48,925 - INFO - Request id 0 done for token 7
2023-05-29 01:04:49,242 - INFO - Request id 1 done for token 7
2023-05-29 01:04:49,574 - INFO - Request id 2 done for token 7
2023-05-29 01:04:49,893 - INFO - Request id 3 done for token 7
2023-05-29 01:04:50,213 - INFO - Request id 0 done for token 8
2023-05-29 01:04:50,532 - INFO - Request id 1 done for token 8
2023-05-29 01:04:50,854 - INFO - Request id 2 done for token 8
2023-05-29 01:04:51,175 - INFO - Request id 3 done for token 8
2023-05-29 01:04:51,493 - INFO - Request id 0 done for token 9
2023-05-29 01:04:51,811 - INFO - Request id 1 done for token 9
2023-05-29 01:04:52,135 - INFO - Request id 2 done for token 9
2023-05-29 01:04:52,456 - INFO - Request id 3 done for token 9
2023-05-29 01:04:52,776 - INFO - Request id 0 done for token 10
2023-05-29 01:04:53,095 - INFO - Request id 1 done for token 10
2023-05-29 01:04:53,416 - INFO - Request id 2 done for token 10
2023-05-29 01:04:53,735 - INFO - Request id 3 done for token 10
2023-05-29 01:04:54,059 - INFO - Request id 0 done for token 11
2023-05-29 01:04:54,373 - INFO - Request id 1 done for token 11
2023-05-29 01:04:54,692 - INFO - Request id 2 done for token 11
2023-05-29 01:04:55,012 - INFO - Request id 3 done for token 11
2023-05-29 01:04:55,331 - INFO - Request id 0 done for token 12
2023-05-29 01:04:55,651 - INFO - Request id 1 done for token 12
2023-05-29 01:04:55,968 - INFO - Request id 2 done for token 12
2023-05-29 01:04:56,288 - INFO - Request id 3 done for token 12
2023-05-29 01:04:56,604 - INFO - Request id 0 done for token 13
2023-05-29 01:04:56,923 - INFO - Request id 1 done for token 13
2023-05-29 01:04:57,244 - INFO - Request id 2 done for token 13
2023-05-29 01:04:57,563 - INFO - Request id 3 done for token 13
2023-05-29 01:04:57,880 - INFO - Request id 0 done for token 14
2023-05-29 01:04:58,200 - INFO - Request id 1 done for token 14
2023-05-29 01:04:58,519 - INFO - Request id 2 done for token 14
2023-05-29 01:04:58,837 - INFO - Request id 3 done for token 14
2023-05-29 01:04:59,160 - INFO - Request id 0 done for token 15
2023-05-29 01:04:59,477 - INFO - Request id 1 done for token 15
2023-05-29 01:04:59,798 - INFO - Request id 2 done for token 15
2023-05-29 01:05:00,120 - INFO - Request id 3 done for token 15
2023-05-29 01:05:00,437 - INFO - Request id 0 done for token 16
2023-05-29 01:05:00,754 - INFO - Request id 1 done for token 16
2023-05-29 01:05:01,072 - INFO - Request id 2 done for token 16
2023-05-29 01:05:01,391 - INFO - Request id 3 done for token 16
2023-05-29 01:05:01,708 - INFO - Request id 0 done for token 17
2023-05-29 01:05:02,028 - INFO - Request id 1 done for token 17
2023-05-29 01:05:02,349 - INFO - Request id 2 done for token 17
2023-05-29 01:05:02,666 - INFO - Request id 3 done for token 17
2023-05-29 01:05:02,986 - INFO - Request id 0 done for token 18
2023-05-29 01:05:03,308 - INFO - Request id 1 done for token 18
2023-05-29 01:05:03,627 - INFO - Request id 2 done for token 18
2023-05-29 01:05:03,948 - INFO - Request id 3 done for token 18
2023-05-29 01:05:04,272 - INFO - Request id 0 done for token 19
2023-05-29 01:05:04,583 - INFO - Request id 1 done for token 19
2023-05-29 01:05:04,907 - INFO - Request id 2 done for token 19
2023-05-29 01:05:05,227 - INFO - Request id 3 done for token 19
2023-05-29 01:05:05,548 - INFO - Request id 0 done for token 20
2023-05-29 01:05:05,868 - INFO - Request id 1 done for token 20
2023-05-29 01:05:06,188 - INFO - Request id 2 done for token 20
2023-05-29 01:05:06,507 - INFO - Request id 3 done for token 20
2023-05-29 01:05:06,826 - INFO - Request id 0 done for token 21
2023-05-29 01:05:07,140 - INFO - Request id 1 done for token 21
2023-05-29 01:05:07,616 - INFO - Request id 2 done for token 21
2023-05-29 01:05:07,930 - INFO - Request id 3 done for token 21
2023-05-29 01:05:08,250 - INFO - Request id 0 done for token 22
2023-05-29 01:05:08,572 - INFO - Request id 1 done for token 22
2023-05-29 01:05:08,895 - INFO - Request id 2 done for token 22
2023-05-29 01:05:09,216 - INFO - Request id 3 done for token 22
2023-05-29 01:05:09,531 - INFO - Request id 0 done for token 23
2023-05-29 01:05:09,853 - INFO - Request id 1 done for token 23
2023-05-29 01:05:10,176 - INFO - Request id 2 done for token 23
2023-05-29 01:05:10,584 - INFO - Request id 3 done for token 23
2023-05-29 01:05:10,812 - INFO - Request id 0 done for token 24
2023-05-29 01:05:11,130 - INFO - Request id 1 done for token 24
2023-05-29 01:05:11,451 - INFO - Request id 2 done for token 24
2023-05-29 01:05:11,771 - INFO - Request id 3 done for token 24
2023-05-29 01:05:12,089 - INFO - Request id 0 done for token 25
2023-05-29 01:05:12,408 - INFO - Request id 1 done for token 25
2023-05-29 01:05:12,728 - INFO - Request id 2 done for token 25
2023-05-29 01:05:13,049 - INFO - Request id 3 done for token 25
2023-05-29 01:05:13,370 - INFO - Request id 0 done for token 26
2023-05-29 01:05:13,691 - INFO - Request id 1 done for token 26
2023-05-29 01:05:14,010 - INFO - Request id 2 done for token 26
2023-05-29 01:05:14,337 - INFO - Request id 3 done for token 26
2023-05-29 01:05:14,648 - INFO - Request id 0 done for token 27
2023-05-29 01:05:14,968 - INFO - Request id 1 done for token 27
2023-05-29 01:05:15,292 - INFO - Request id 2 done for token 27
2023-05-29 01:05:15,609 - INFO - Request id 3 done for token 27
2023-05-29 01:05:15,929 - INFO - Request id 0 done for token 28
2023-05-29 01:05:16,247 - INFO - Request id 1 done for token 28
2023-05-29 01:05:16,568 - INFO - Request id 2 done for token 28
2023-05-29 01:05:16,887 - INFO - Request id 3 done for token 28
2023-05-29 01:05:17,205 - INFO - Request id 0 done for token 29
2023-05-29 01:05:17,526 - INFO - Request id 1 done for token 29
2023-05-29 01:05:17,847 - INFO - Request id 2 done for token 29
2023-05-29 01:05:18,162 - INFO - Request id 3 done for token 29
2023-05-29 01:05:18,480 - INFO - Request id 0 done for token 30
2023-05-29 01:05:18,803 - INFO - Request id 1 done for token 30
2023-05-29 01:05:19,120 - INFO - Request id 2 done for token 30
2023-05-29 01:05:19,439 - INFO - Request id 3 done for token 30
2023-05-29 01:05:19,759 - INFO - Request id 0 done for token 31
2023-05-29 01:05:20,077 - INFO - Request id 1 done for token 31
2023-05-29 01:05:20,396 - INFO - Request id 2 done for token 31
2023-05-29 01:05:20,719 - INFO - Request id 3 done for token 31
2023-05-29 01:05:21,039 - INFO - Request id 0 done for token 32
2023-05-29 01:05:21,358 - INFO - Request id 1 done for token 32
2023-05-29 01:05:21,676 - INFO - Request id 2 done for token 32
2023-05-29 01:05:21,993 - INFO - Request id 3 done for token 32
2023-05-29 01:05:22,311 - INFO - Request id 0 done for token 33
2023-05-29 01:05:22,633 - INFO - Request id 1 done for token 33
2023-05-29 01:05:22,951 - INFO - Request id 2 done for token 33
2023-05-29 01:05:23,269 - INFO - Request id 3 done for token 33
2023-05-29 01:05:23,590 - INFO - Request id 0 done for token 34
2023-05-29 01:05:23,911 - INFO - Request id 1 done for token 34
2023-05-29 01:05:24,228 - INFO - Request id 2 done for token 34
2023-05-29 01:05:24,548 - INFO - Request id 3 done for token 34
2023-05-29 01:05:24,866 - INFO - Request id 0 done for token 35
2023-05-29 01:05:25,188 - INFO - Request id 1 done for token 35
2023-05-29 01:05:25,509 - INFO - Request id 2 done for token 35
2023-05-29 01:05:25,830 - INFO - Request id 3 done for token 35
2023-05-29 01:05:26,155 - INFO - Request id 0 done for token 36
2023-05-29 01:05:26,471 - INFO - Request id 1 done for token 36
2023-05-29 01:05:26,790 - INFO - Request id 2 done for token 36
2023-05-29 01:05:27,108 - INFO - Request id 3 done for token 36
2023-05-29 01:05:27,426 - INFO - Request id 0 done for token 37
2023-05-29 01:05:27,749 - INFO - Request id 1 done for token 37
2023-05-29 01:05:28,062 - INFO - Request id 2 done for token 37
2023-05-29 01:05:28,380 - INFO - Request id 3 done for token 37
2023-05-29 01:05:28,699 - INFO - Request id 0 done for token 38
2023-05-29 01:05:29,018 - INFO - Request id 1 done for token 38
2023-05-29 01:05:29,337 - INFO - Request id 2 done for token 38
2023-05-29 01:05:29,658 - INFO - Request id 3 done for token 38
2023-05-29 01:05:29,977 - INFO - Request id 0 done for token 39
2023-05-29 01:05:30,295 - INFO - Request id 1 done for token 39
2023-05-29 01:05:30,617 - INFO - Request id 2 done for token 39
2023-05-29 01:05:30,935 - INFO - Request id 3 done for token 39
2023-05-29 01:05:31,251 - INFO - Request id 0 done for token 40
2023-05-29 01:05:31,572 - INFO - Request id 1 done for token 40
2023-05-29 01:05:31,889 - INFO - Request id 2 done for token 40
2023-05-29 01:05:32,207 - INFO - Request id 3 done for token 40
2023-05-29 01:05:32,525 - INFO - Request id 0 done for token 41
2023-05-29 01:05:32,842 - INFO - Request id 1 done for token 41
2023-05-29 01:05:33,163 - INFO - Request id 2 done for token 41
2023-05-29 01:05:33,485 - INFO - Request id 3 done for token 41
2023-05-29 01:05:33,806 - INFO - Request id 0 done for token 42
2023-05-29 01:05:34,125 - INFO - Request id 1 done for token 42
2023-05-29 01:05:34,446 - INFO - Request id 2 done for token 42
2023-05-29 01:05:34,768 - INFO - Request id 3 done for token 42
2023-05-29 01:05:35,088 - INFO - Request id 0 done for token 43
2023-05-29 01:05:35,409 - INFO - Request id 1 done for token 43
2023-05-29 01:05:35,728 - INFO - Request id 2 done for token 43
2023-05-29 01:05:36,050 - INFO - Request id 3 done for token 43
2023-05-29 01:05:36,371 - INFO - Request id 0 done for token 44
2023-05-29 01:05:36,689 - INFO - Request id 1 done for token 44
2023-05-29 01:05:37,007 - INFO - Request id 2 done for token 44
2023-05-29 01:05:37,330 - INFO - Request id 3 done for token 44
2023-05-29 01:05:37,651 - INFO - Request id 0 done for token 45
2023-05-29 01:05:37,972 - INFO - Request id 1 done for token 45
2023-05-29 01:05:38,290 - INFO - Request id 2 done for token 45
2023-05-29 01:05:38,611 - INFO - Request id 3 done for token 45
2023-05-29 01:05:38,947 - INFO - Request id 0 done for token 46
2023-05-29 01:05:39,280 - INFO - Request id 1 done for token 46
2023-05-29 01:05:39,579 - INFO - Request id 2 done for token 46
2023-05-29 01:05:39,898 - INFO - Request id 3 done for token 46
2023-05-29 01:05:40,217 - INFO - Request id 0 done for token 47
2023-05-29 01:05:40,539 - INFO - Request id 1 done for token 47
2023-05-29 01:05:40,863 - INFO - Request id 2 done for token 47
2023-05-29 01:05:41,180 - INFO - Request id 3 done for token 47
2023-05-29 01:05:41,500 - INFO - Request id 0 done for token 48
2023-05-29 01:05:41,819 - INFO - Request id 1 done for token 48
2023-05-29 01:05:42,139 - INFO - Request id 2 done for token 48
2023-05-29 01:05:42,460 - INFO - Request id 3 done for token 48
2023-05-29 01:05:42,776 - INFO - Request id 0 done for token 49
2023-05-29 01:05:43,105 - INFO - Request id 1 done for token 49
2023-05-29 01:05:43,425 - INFO - Request id 2 done for token 49
2023-05-29 01:05:43,743 - INFO - Request id 3 done for token 49
2023-05-29 01:05:44,063 - INFO - Request id 0 done for token 50
2023-05-29 01:05:44,385 - INFO - Request id 1 done for token 50
2023-05-29 01:05:44,705 - INFO - Request id 2 done for token 50
2023-05-29 01:05:45,026 - INFO - Request id 3 done for token 50
2023-05-29 01:05:45,349 - INFO - Request id 0 done for token 51
2023-05-29 01:05:45,667 - INFO - Request id 1 done for token 51
2023-05-29 01:05:45,989 - INFO - Request id 2 done for token 51
2023-05-29 01:05:46,319 - INFO - Request id 3 done for token 51
2023-05-29 01:05:46,639 - INFO - Request id 0 done for token 52
2023-05-29 01:05:46,955 - INFO - Request id 1 done for token 52
2023-05-29 01:05:47,282 - INFO - Request id 2 done for token 52
2023-05-29 01:05:47,606 - INFO - Request id 3 done for token 52
2023-05-29 01:05:47,926 - INFO - Request id 0 done for token 53
2023-05-29 01:05:48,244 - INFO - Request id 1 done for token 53
2023-05-29 01:05:48,564 - INFO - Request id 2 done for token 53
2023-05-29 01:05:48,885 - INFO - Request id 3 done for token 53
2023-05-29 01:05:49,203 - INFO - Request id 0 done for token 54
2023-05-29 01:05:49,521 - INFO - Request id 1 done for token 54
2023-05-29 01:05:49,844 - INFO - Request id 2 done for token 54
2023-05-29 01:05:50,163 - INFO - Request id 3 done for token 54
2023-05-29 01:05:50,481 - INFO - Request id 0 done for token 55
2023-05-29 01:05:50,801 - INFO - Request id 1 done for token 55
2023-05-29 01:05:51,123 - INFO - Request id 2 done for token 55
2023-05-29 01:05:51,445 - INFO - Request id 3 done for token 55
2023-05-29 01:05:51,769 - INFO - Request id 0 done for token 56
2023-05-29 01:05:52,087 - INFO - Request id 1 done for token 56
2023-05-29 01:05:52,409 - INFO - Request id 2 done for token 56
2023-05-29 01:05:52,727 - INFO - Request id 3 done for token 56
2023-05-29 01:05:53,045 - INFO - Request id 0 done for token 57
2023-05-29 01:05:53,363 - INFO - Request id 1 done for token 57
2023-05-29 01:05:53,687 - INFO - Request id 2 done for token 57
2023-05-29 01:05:54,006 - INFO - Request id 3 done for token 57
2023-05-29 01:05:54,324 - INFO - Request id 0 done for token 58
2023-05-29 01:05:54,647 - INFO - Request id 1 done for token 58
2023-05-29 01:05:54,963 - INFO - Request id 2 done for token 58
2023-05-29 01:05:55,282 - INFO - Request id 3 done for token 58
2023-05-29 01:05:55,602 - INFO - Request id 0 done for token 59
2023-05-29 01:05:55,924 - INFO - Request id 1 done for token 59
2023-05-29 01:05:56,245 - INFO - Request id 2 done for token 59
2023-05-29 01:05:56,568 - INFO - Request id 3 done for token 59
2023-05-29 01:05:56,889 - INFO - Request id 0 done for token 60
2023-05-29 01:05:57,210 - INFO - Request id 1 done for token 60
2023-05-29 01:05:57,535 - INFO - Request id 2 done for token 60
2023-05-29 01:05:57,852 - INFO - Request id 3 done for token 60
2023-05-29 01:05:58,170 - INFO - Request id 0 done for token 61
2023-05-29 01:05:58,491 - INFO - Request id 1 done for token 61
2023-05-29 01:05:58,809 - INFO - Request id 2 done for token 61
2023-05-29 01:05:59,127 - INFO - Request id 3 done for token 61
2023-05-29 01:05:59,446 - INFO - Request id 0 done for token 62
2023-05-29 01:05:59,768 - INFO - Request id 1 done for token 62
2023-05-29 01:06:00,092 - INFO - Request id 2 done for token 62
2023-05-29 01:06:00,421 - INFO - Request id 3 done for token 62
2023-05-29 01:06:00,741 - INFO - Request id 0 done for token 63
2023-05-29 01:06:01,060 - INFO - Request id 1 done for token 63
2023-05-29 01:06:01,381 - INFO - Request id 2 done for token 63
2023-05-29 01:06:01,704 - INFO - Request id 3 done for token 63
2023-05-29 01:06:02,033 - INFO - Request id 0 done for token 64
2023-05-29 01:06:02,352 - INFO - Request id 1 done for token 64
2023-05-29 01:06:02,672 - INFO - Request id 2 done for token 64
2023-05-29 01:06:02,994 - INFO - Request id 3 done for token 64
2023-05-29 01:06:03,317 - INFO - Request id 0 done for token 65
2023-05-29 01:06:03,636 - INFO - Request id 1 done for token 65
2023-05-29 01:06:03,956 - INFO - Request id 2 done for token 65
2023-05-29 01:06:04,276 - INFO - Request id 3 done for token 65
2023-05-29 01:06:04,597 - INFO - Request id 0 done for token 66
2023-05-29 01:06:04,919 - INFO - Request id 1 done for token 66
2023-05-29 01:06:05,242 - INFO - Request id 2 done for token 66
2023-05-29 01:06:05,564 - INFO - Request id 3 done for token 66
2023-05-29 01:06:05,883 - INFO - Request id 0 done for token 67
2023-05-29 01:06:06,205 - INFO - Request id 1 done for token 67
2023-05-29 01:06:06,524 - INFO - Request id 2 done for token 67
2023-05-29 01:06:06,844 - INFO - Request id 3 done for token 67
2023-05-29 01:06:07,166 - INFO - Request id 0 done for token 68
2023-05-29 01:06:07,674 - INFO - Request id 1 done for token 68
2023-05-29 01:06:07,994 - INFO - Request id 2 done for token 68
2023-05-29 01:06:08,315 - INFO - Request id 3 done for token 68
2023-05-29 01:06:08,634 - INFO - Request id 0 done for token 69
2023-05-29 01:06:08,956 - INFO - Request id 1 done for token 69
2023-05-29 01:06:09,278 - INFO - Request id 2 done for token 69
2023-05-29 01:06:09,599 - INFO - Request id 3 done for token 69
2023-05-29 01:06:09,918 - INFO - Request id 0 done for token 70
2023-05-29 01:06:10,240 - INFO - Request id 1 done for token 70
2023-05-29 01:06:10,560 - INFO - Request id 2 done for token 70
2023-05-29 01:06:10,880 - INFO - Request id 3 done for token 70
2023-05-29 01:06:11,203 - INFO - Request id 0 done for token 71
2023-05-29 01:06:11,523 - INFO - Request id 1 done for token 71
2023-05-29 01:06:11,844 - INFO - Request id 2 done for token 71
2023-05-29 01:06:12,167 - INFO - Request id 3 done for token 71
2023-05-29 01:06:12,487 - INFO - Request id 0 done for token 72
2023-05-29 01:06:12,809 - INFO - Request id 1 done for token 72
2023-05-29 01:06:13,129 - INFO - Request id 2 done for token 72
2023-05-29 01:06:13,453 - INFO - Request id 3 done for token 72
2023-05-29 01:06:13,771 - INFO - Request id 0 done for token 73
2023-05-29 01:06:14,092 - INFO - Request id 1 done for token 73
2023-05-29 01:06:14,414 - INFO - Request id 2 done for token 73
2023-05-29 01:06:14,736 - INFO - Request id 3 done for token 73
2023-05-29 01:06:15,057 - INFO - Request id 0 done for token 74
2023-05-29 01:06:15,378 - INFO - Request id 1 done for token 74
2023-05-29 01:06:15,699 - INFO - Request id 2 done for token 74
2023-05-29 01:06:16,020 - INFO - Request id 3 done for token 74
2023-05-29 01:06:16,340 - INFO - Request id 0 done for token 75
2023-05-29 01:06:16,662 - INFO - Request id 1 done for token 75
2023-05-29 01:06:16,984 - INFO - Request id 2 done for token 75
2023-05-29 01:06:17,304 - INFO - Request id 3 done for token 75
2023-05-29 01:06:17,625 - INFO - Request id 0 done for token 76
2023-05-29 01:06:17,945 - INFO - Request id 1 done for token 76
2023-05-29 01:06:18,266 - INFO - Request id 2 done for token 76
2023-05-29 01:06:18,588 - INFO - Request id 3 done for token 76
2023-05-29 01:06:18,909 - INFO - Request id 0 done for token 77
2023-05-29 01:06:19,230 - INFO - Request id 1 done for token 77
2023-05-29 01:06:19,556 - INFO - Request id 2 done for token 77
2023-05-29 01:06:19,872 - INFO - Request id 3 done for token 77
2023-05-29 01:06:20,222 - INFO - Request id 0 done for token 78
2023-05-29 01:06:20,543 - INFO - Request id 1 done for token 78
2023-05-29 01:06:20,864 - INFO - Request id 2 done for token 78
2023-05-29 01:06:21,188 - INFO - Request id 3 done for token 78
2023-05-29 01:06:21,508 - INFO - Request id 0 done for token 79
2023-05-29 01:06:21,826 - INFO - Request id 1 done for token 79
2023-05-29 01:06:22,147 - INFO - Request id 2 done for token 79
2023-05-29 01:06:22,471 - INFO - Request id 3 done for token 79
2023-05-29 01:06:23,744 - INFO - Latency is 116.806563, throughput is 0.273957
2023-05-29 01:06:23,744 - INFO - Token throughput is 21.916577
2023-05-29 01:06:23,775 - INFO - handle_cmd: stop
2023-05-29 01:06:23,782 - INFO - handle_cmd: stop
2023-05-29 01:06:23,808 - INFO - handle_cmd: stop
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /opt/tiger/launch/qsync/QPipe/tests/main_p2p.py:329 in <module>                                  │
│                                                                                                  │
│   326 │   │   model_pre_and_post = model_pre_and_post.cuda()                                     │
│   327 │                                                                                          │
│   328 │   run_pipeline_p2p(loaded_llm_cpu, dist_cfg, sharding_strategy=sharding_strategy)        │
│ ❱ 329 │   simple_queue_thread.join()                                                             │
│   330 │   # from torch import profiler                                                           │
│   331 │   # from torch.profiler import profile, record_function, ProfilerActivity                │
│   332 │   # with profiler.profile(activities=[ProfilerActivity.CPU, ProfilerActivity.CUDA], wi   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'NoneType' object has no attribute 'join'
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /opt/tiger/launch/qsync/QPipe/tests/main_p2p.py:329 in <module>                                  │
│                                                                                                  │
│   326 │   │   model_pre_and_post = model_pre_and_post.cuda()                                     │
│   327 │                                                                                          │
│   328 │   run_pipeline_p2p(loaded_llm_cpu, dist_cfg, sharding_strategy=sharding_strategy)        │
│ ❱ 329 │   simple_queue_thread.join()                                                             │
│   330 │   # from torch import profiler                                                           │
│   331 │   # from torch.profiler import profile, record_function, ProfilerActivity                │
│   332 │   # with profiler.profile(activities=[ProfilerActivity.CPU, ProfilerActivity.CUDA], wi   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'NoneType' object has no attribute 'join'
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /opt/tiger/launch/qsync/QPipe/tests/main_p2p.py:329 in <module>                                  │
│                                                                                                  │
│   326 │   │   model_pre_and_post = model_pre_and_post.cuda()                                     │
│   327 │                                                                                          │
│   328 │   run_pipeline_p2p(loaded_llm_cpu, dist_cfg, sharding_strategy=sharding_strategy)        │
│ ❱ 329 │   simple_queue_thread.join()                                                             │
│   330 │   # from torch import profiler                                                           │
│   331 │   # from torch.profiler import profile, record_function, ProfilerActivity                │
│   332 │   # with profiler.profile(activities=[ProfilerActivity.CPU, ProfilerActivity.CUDA], wi   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'NoneType' object has no attribute 'join'
Exception in thread Thread-337:
Traceback (most recent call last):
  File "/usr/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/home/tiger/.local/lib/python3.9/site-packages/qpipe/p2p/util.py", line 24, in run
    self._req.wait()
RuntimeError: [../third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.176.100.32]:1443
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 18518 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 18520 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 18521 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 18519) of binary: /usr/bin/python3
Traceback (most recent call last):
  File "/usr/local/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/usr/local/lib/python3.9/dist-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main_p2p.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-05-29_01:06:25
  host      : n176-100-032.byted.org
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 18519)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
